(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{698:function(a,t,s){"use strict";s.r(t);var n=s(16),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"linux-内存缓慢增长问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linux-内存缓慢增长问题"}},[a._v("#")]),a._v(" linux 内存缓慢增长问题")]),a._v(" "),s("p",[a._v("在遇到 内存、cpu 等系统资源 缓慢增长问题时，可以使用类似的脚本进行数据采样，然后通过对格式化数据分析找到 具体的服务(进程)。")]),a._v(" "),s("h2",{attrs:{id:"监控脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监控脚本"}},[a._v("#")]),a._v(" 监控脚本")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('    #!/bin/bash\n\n    # */1 * * * * bash /data/data_tmp/monitor.sh\n\n    now=`date +%Y%m%d`\n    /usr/bin/top -c -b -n 1 | sort -nr -k10 | head -n 20 | tee >>/data/data_tmp/top_$now.txt\n\n    tow_days_ago=`date +%Y%m%d -d "5 day ago"`\n    if [ -f /data/data_tmp/top_${tow_days_ago}.txt ];then\n    rm -f /data/data_tmp/top_${tow_days_ago}.txt\n    fi\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("h2",{attrs:{id:"分析数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析数据"}},[a._v("#")]),a._v(" 分析数据")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("    # 按进程名分组写入不同的文件\n    cat tmp.txt | grep -v % | grep -v KiB | grep -v Tasks | sort -r -k12 -k11 | awk '{print $0 >> $12\".rlog\"}'\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{516:function(e,t,r){e.exports=r.p+"assets/img/sample_vba_a.0fe98adb.png"},517:function(e,t,r){e.exports=r.p+"assets/img/sample_vba_b.d7aaebc3.png"},518:function(e,t,r){e.exports=r.p+"assets/img/office2007_template_inject.d12403d6.png"},519:function(e,t,r){e.exports=r.p+"assets/img/cfb_sectors.376a1dbc.png"},520:function(e,t,r){e.exports=r.p+"assets/img/cfb_summary.74375884.png"},521:function(e,t,r){e.exports=r.p+"assets/img/ole_embedded_object.5730fecc.jpg"},522:function(e,t,r){e.exports=r.p+"assets/img/ole_linked_object.8828ce15.jpg"},523:function(e,t,r){e.exports=r.p+"assets/img/vba_storage_hierarchy.901caaf9.png"},524:function(e,t,r){e.exports=r.p+"assets/img/sample_vba_project.c635a9d2.png"},525:function(e,t){e.exports="data:image/png;base64,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"},723:function(e,t,r){"use strict";r.r(t);var a=r(16),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"office-格式简析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#office-格式简析"}},[e._v("#")]),e._v(" Office 格式简析")]),e._v(" "),a("p",[e._v("目前常见的 Microsoft Office 格式主要分为 97 ~ 2003 和 2007 ~ 两种格式。"),a("code",[e._v("Microsoft Office 97 ~ 2003")]),e._v(" 的文件格式都是由 MS-CFB 结构来表示的 OLE 文件。"),a("code",[e._v("Microsoft Office 2007 ~")]),e._v("则是由 OOXML 格式的文件结构压缩而成的 zip 包来存储。")]),e._v(" "),a("p",[e._v("而 OOXML 又是以 XML 文件为基础的，所以，概括的说，Office文档主要基于 ole、xml、ooxml 这三种文件格式构建起来的。")]),e._v(" "),a("p",[e._v("常见的文件扩展名以及用途如下：")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[e._v("Extensions")]),e._v(" "),a("th",[e._v("Usage")]),e._v(" "),a("th",[e._v("Remark")])])]),e._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[e._v("doc、xls、ppt")]),e._v(" "),a("td",[e._v("属于 97-2003 版 Office")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[e._v("docx、xlsx、pptx")]),e._v(" "),a("td",[e._v("属于 2007 ~ 版 Office 文档，但没有启用宏")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[e._v("docm、xlsm、pptm")]),e._v(" "),a("td",[e._v("属于启用了宏的 2007 ~ 版 Office 文档，可以存储 Visual Basic Applications（VBA）宏代码")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[e._v("ppsx")]),e._v(" "),a("td",[e._v("是 2007 的 PPT 的一种格式，打开就是幻灯片播放模式")]),e._v(" "),a("td")])])]),e._v(" "),a("p",[e._v("按照我们常规的认知，一个文档应当包含以下几个部分：")]),e._v(" "),a("ol",[a("li",[e._v("文档内容\n"),a("ul",[a("li",[e._v("可能涉及对 embedded objects 或 external objects 的引用")]),e._v(" "),a("li",[e._v("文档的展示相关：字体、页面大小、打印方式等等")])])]),e._v(" "),a("li",[e._v("文档工具\n"),a("ul",[a("li",[e._v("为了更好、更方便的操作文档内容进行编辑、展示、提示以及其他功能，而提供的一些跟文档相关的组件，如 vba、formula、animation 等等")])])]),e._v(" "),a("li",[e._v("文档属性\n"),a("ul",[a("li",[e._v("如，创作时间、作者、最后修改时间等等")])])]),e._v(" "),a("li",[e._v("保护措施\n"),a("ul",[a("li",[e._v("签名")]),e._v(" "),a("li",[e._v("读(打开)、写 保护")])])])]),e._v(" "),a("h2",{attrs:{id:"一、malware"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、malware"}},[e._v("#")]),e._v(" 一、Malware")]),e._v(" "),a("p",[e._v("由于 ms-office 文件的广泛使用，恶意软件作者对其进行了充分的挖掘、利用，催生出了一系列针对这些文档的病毒，期中常常被用于恶意目的的组件或者方式有：宏病毒、漏洞利用、嵌入文件")]),e._v(" "),a("h3",{attrs:{id:"_1-1-漏洞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-漏洞"}},[e._v("#")]),e._v(" 1.1 漏洞")]),e._v(" "),a("p",[e._v("漏洞利用是指软件自身缺陷被攻击者利用来执行高危动作，如利用 ole 的特点调用第三方组件并执行；栈溢出造成的任意代码执行漏洞(CVE-2017-11882) 等等，常见的漏洞有：")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:""}},[e._v("CVE-2017-11882")])]),e._v(" "),a("li",[a("a",{attrs:{href:"https://www.secpulse.com/archives/67027.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("CVE-2018-0802"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2019-0801",target:"_blank",rel:"noopener noreferrer"}},[e._v("CVE-2019-0801"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://bbs.pediy.com/thread-269266.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("CVE-2021-40444"),a("OutboundLink")],1)])]),e._v(" "),a("h3",{attrs:{id:"_1-2-宏病毒"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-宏病毒"}},[e._v("#")]),e._v(" 1.2 宏病毒")]),e._v(" "),a("p",[e._v("宏（Macro）是 ms-office 提供的一种利用一系列独立的 office 命令来实现任务执行的自动化，以简化日常工作的工具。当前的 ms-office 是使用 Visual Basic for Applications（VBA）编写的，它是 Microsoft 的 Visual Basic 编程语言专门为 Office 服务的一种变体。VBA 可在大多数 Office 程序中使用，例如 Access，Excel，Outlook，PowerPoint，Project，Publisher，Visio 和 Word 等等。")]),e._v(" "),a("p",[e._v("宏病毒主要是利用 宏 来进行感染和传播。它利用宏语言的功能寄存在文档或模板中，一旦带有宏病毒的文档被打开，宏就可能会执行，而宏病毒就会被激活。")]),e._v(" "),a("p",[e._v("它的主要感染路径大致如下："),a("code",[e._v("单个Office文档 => Office文档模板 => 多个Office文档")]),e._v("。")]),e._v(" "),a("p",[e._v("常见的宏主要存在于以下两种形式(vba && xlm)：\n"),a("center",{staticClass:"half"},[a("img",{attrs:{src:r(516),width:"300"}}),e._v(" "),a("img",{attrs:{src:r(517),width:"460"}})])],1),e._v(" "),a("p",[e._v("此外，还有一种攻击方式被称为「模板注入」，实际上还是上述两种 macros 的利用，不过内容可能会随时发生变化")]),e._v(" "),a("ul",[a("li",[a("img",{attrs:{src:r(518),alt:"office2007_template_inject"}})])]),e._v(" "),a("p",[e._v("此外，宏病毒常常用以下方式保护、隐藏自己：")]),e._v(" "),a("ol",[a("li",[e._v("禁止提示信息")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("On Error Resume Next                     '如果发生错误，不弹出出错窗口，继续执行下面语句\nApplication.DisplayAlerts = wdAlertsNone '不弹出警告窗口\nApplication.DisplayStatusBar = False     '不显示状态栏，以免显示宏的运行状态\nOptions.VirusProtection = False          '关闭病毒保护功能，运行前如果包含宏，不提示\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("屏蔽命令菜单，不许查看宏")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("' Disable或者删除特定菜单项，用来使“工具—宏”菜单失效的语句：\nCommandBars(“Tools”).Controls(16).Enabled = False\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[e._v("隐藏宏的真实代码")])]),e._v(" "),a("ul",[a("li",[e._v("在“自动宏”中，不包括任何感染或破坏的代码，但包含了创建、执行和删除新宏（实际进行感染和破坏的宏）的代码；将宏代码字体颜色设置成与背景一样的白色等")]),e._v(" "),a("li",[e._v("“自动宏” 是指利用 AutoExec、AutoNew、AutoOpen、AutoClose、AutoExit 自动触发执行的宏")])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("文档密码保护")])]),e._v(" "),a("ul",[a("li",[e._v("打开文档时需要密码 或者 查看vba脚本时需要密码")])]),e._v(" "),a("p",[e._v("另外，病毒作者常用"),a("strong",[e._v("密码逃逸")]),e._v("手段以增加检测难度，事实上也很有效。这种方法的全称是："),a("code",[e._v("VelvetSweatshop Default Password Ploy")]),e._v("。")]),e._v(" "),a("ul",[a("li",[e._v("对象：Excel 4.0 xls 97 ~ files with a compromised macro")]),e._v(" "),a("li",[e._v("表现：XLS files appear password protected but aren’t, opening automatically to install malware from compromised macros.")]),e._v(" "),a("li",[e._v("原因：Excel 会首先尝试使用默认密码 'VelvetSweatshop' 以 read-only 模式打开文件，如果失败时，再向用户要求输入密码。(This read-only technique has been known about for over 10 years.)")]),e._v(" "),a("li",[e._v("Reference\n"),a("ul",[a("li",[e._v("https://threatpost.com/hackers-update-age-old-excel-4-0-macro-attack/154898/")])])])]),e._v(" "),a("h3",{attrs:{id:"_1-3-embedded"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-embedded"}},[e._v("#")]),e._v(" 1.3 Embedded")]),e._v(" "),a("p",[e._v("利用复合文档可以内嵌其它文档的特性，可以嵌套如：")]),e._v(" "),a("ul",[a("li",[e._v("images、video、audio")]),e._v(" "),a("li",[e._v("other streams, eg. rtf、pdf、docx ... (rtf、docx等复合文档又可以继续嵌套... MY GOD ~)")])]),e._v(" "),a("h2",{attrs:{id:"二、ms-cfb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、ms-cfb"}},[e._v("#")]),e._v(" 二、MS-CFB")]),e._v(" "),a("p",[e._v("经常被称为 OLE(Object Linking and Embedded)，实际上 OLE (是一种面向对象的技术)包含的内容更多，是 COM 技术的基础，而 CFB 只是 OLE 中关于文件格式的一种描述。")]),e._v(" "),a("p",[e._v("复合文档的物理结构比较简单：")]),e._v(" "),a("ul",[a("li",[a("img",{attrs:{src:r(519),alt:"cfb_sectors"}})])]),e._v(" "),a("p",[a("em",[e._v("注意：Compound File Header (512 bytes)也会独占一个 sector, 没有用到的地方填充 0.")])]),e._v(" "),a("p",[e._v("这里是逻辑结构：")]),e._v(" "),a("ul",[a("li",[a("img",{attrs:{src:r(520),alt:"cfb_summary"}})])]),e._v(" "),a("p",[e._v("文档中的内容都以 stream 来保持具体内容，storage 来组织 stream 的结构。而这些内容在文件中的位置、查找方式、解读方式，就由 "),a("code",[e._v("Directory Entry Array")]),e._v(" 来表达。")]),e._v(" "),a("p",[e._v("复合文档的结构非常类似 FAT 文件系统，storage 相当于 directory，stream 相当于 file。为了文件的快速定位，我们需要相应的分区索引表(DiFat 和 Fat)。在 复合文档中，为了节省空间，会将 sector 划分成等长的 "),a("code",[e._v("short-sector")]),e._v(" 用于小对象("),a("code",[e._v("short-stream")]),e._v(")的存储，而它的索引需要 "),a("code",[e._v("Mini-Fat")]),e._v("。")]),e._v(" "),a("p",[e._v("由于 CFB 文件由 sectors 组成，这里统一称呼为：")]),e._v(" "),a("ul",[a("li",[e._v("msat (master sector allocation table)，又名 DiFat")]),e._v(" "),a("li",[e._v("sat (sector allocation table)，又名 Fat")]),e._v(" "),a("li",[e._v("ssat (short-sector allocation table)")]),e._v(" "),a("li",[e._v("stream")]),e._v(" "),a("li",[e._v("short_stream")])]),e._v(" "),a("p",[e._v("他们的功能如下：")]),e._v(" "),a("ul",[a("li",[e._v("msat 表包含了用于构造 sat 表的 sectors 的 sid")]),e._v(" "),a("li",[e._v("sat 表包含了很多 sid 链(有特定的 sid 标识链条结束)\n"),a("ul",[a("li",[e._v("每个 sid 链上的 sectors 联合构成了一个完整的 object (如，stream、storage、directory entry array、ssat ...)的物理存储。")])])]),e._v(" "),a("li",[e._v("ssat 表包含了很多 ssid 链(有特定的 ssid 标识链条结束)\n"),a("ul",[a("li",[e._v("每个 ssid 链上的 short-sectors 联合构成了一个完整的 short-stream")])])])]),e._v(" "),a("p",[e._v("到这里，我们大概可以想到为了解析 CFB 结构，需要知道以下几个内容：")]),e._v(" "),a("ol",[a("li",[e._v("Directory Entry 的结构 和 存放位置")]),e._v(" "),a("li",[e._v("msat 表在文件中的位置")]),e._v(" "),a("li",[e._v("stream 和 short-stream 的切割点：什么情况下用 stream 什么时候用 short-stream")]),e._v(" "),a("li",[e._v("short-sector 存储于哪些 sector 中")]),e._v(" "),a("li",[e._v("ssid 存储于哪些 sector 中")])]),e._v(" "),a("p",[e._v("这些内容就存放在 Compound File Header 和 Directory Entry Root 中。")]),e._v(" "),a("h2",{attrs:{id:"ole"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ole"}},[e._v("#")]),e._v(" OLE")]),e._v(" "),a("p",[e._v("OLE, Object Linking and Embedded。")]),e._v(" "),a("p",[e._v("微软在 1991 年制定的 OLE1.0 规范，主要解决多个应用程序之间的通信和消息传递问题，微软希望第三方开发商能够遵守这个规范，以使在当时的Windows平台上的应用程序能够相互协调工作，更大的提高工作效率。然而事与愿违，只有很少的软件开发商支持它。为此，微软于1993 年发布了新的规范 OLE2.0，它在原有的基础上完善并增强了以下各方面的性能：")]),e._v(" "),a("ol",[a("li",[e._v("OLE自动化：一个程序有计划地控制另一个程序的能力。")]),e._v(" "),a("li",[e._v("OLE控件：小型的组件程序，可嵌入到另外的程序，提供自己的专有功能。")]),e._v(" "),a("li",[e._v("OLE文档：完善了早期的混合文档功能，不仅支持简单链接和嵌入，还支持在位激活、拖放等功能。")])]),e._v(" "),a("p",[e._v("强大的功能使得很多的开发商开始支持新的 OLE 技术，因为微软在 OLE2.0 中建立了 COM（Component Object Model即组件对象模式）规范。")]),e._v(" "),a("p",[e._v("OLE 相关的基础概念有：")]),e._v(" "),a("ul",[a("li",[e._v("容器：\n"),a("ul",[a("li",[e._v("容器是一个客户程序，它具有申请并使用其它COM组件通过接口为其它程序实现的功能；")])])]),e._v(" "),a("li",[e._v("服务器：\n"),a("ul",[a("li",[e._v("服务器通过特定的接口将自己完成的一些功能，提供给使用自己的应用程序（例如画笔程序是一个文档服务器，它提供创建并编辑BMP 图像的功能）。当打开Word，选择【插入】菜单下的【对象...】项，您可以看到在您的系统中存在哪些文档服务器，此时的Word以文档容器的身份出现。")])])]),e._v(" "),a("li",[e._v("在位激活：\n"),a("ul",[a("li",[e._v("当您双击插入的对象后发现Word的菜单有些改变成文档服务器程序的菜单，可以在当前的环境下编辑对象，这称为在位激活。")])])])]),e._v(" "),a("p",[e._v("简单的说，OLE 是一种可以用来创建复杂文档的技术，这些复杂文档可以包含来自不同渠道（数据源）的信息，并保留其原始属性。例如，一个支持 OLE 的文档（例如word）能够支持嵌入的表格对象，并且嵌入的文档会保留所有原来的属性。如果用户打算编辑嵌入的数据，windows 操作系统会激活原来的应用程序（如excel）并载入这个嵌入的文档。")]),e._v(" "),a("h3",{attrs:{id:"ole-格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ole-格式"}},[e._v("#")]),e._v(" OLE 格式")]),e._v(" "),a("p",[e._v("OLE 文件的 Property Sets 通过以下两个 stream 存储:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v('"\\005SummaryInformation"')])]),e._v(" "),a("li",[a("code",[e._v('"\\005DocumentSummaryInformation"')])])]),e._v(" "),a("p",[e._v("这两个 stream 都以 PropertySetStream 结构(见 "),a("a",{attrs:{href:""}},[e._v("MS-OSHARED")]),e._v(" 的 section3.2.1 )开头。")]),e._v(" "),a("p",[e._v("OLE文件中包含的常见内容主要有：")]),e._v(" "),a("h4",{attrs:{id:"_1-linked-or-embedded-object"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-linked-or-embedded-object"}},[e._v("#")]),e._v(" 1. linked or embedded object")]),e._v(" "),a("p",[e._v("包含嵌入、链接对象的容器文档的逻辑布局如下图：\n"),a("center",{staticClass:"half"},[a("img",{attrs:{src:r(521),width:"460"}}),e._v(" "),a("img",{attrs:{src:r(522),width:"300"}})])],1),e._v(" "),a("ul",[a("li",[e._v("OLEStream\n"),a("ul",[a("li",[e._v('OLE2.0 中，由复合文档的以 "\\1Ole" 为名的 stream object 包含。OLEStream structure 表述了存储对象是用于 linked object 还是 embedded object。当此结构是为 linked object 指定 storage object 时，它还指定了对此链接对象的引用。')])])]),e._v(" "),a("li",[e._v("CompObjStream\n"),a("ul",[a("li",[e._v('OLE2.0 中，名为 "\\1CompObj" 的流，主要用于描述 Clipboard Format、用于显示的linked object 或 embedded object 的名字。')])])]),e._v(" "),a("li",[e._v("Embedded Object Native Data\n"),a("ul",[a("li",[e._v("OLE1.0 中，其由 EmbeddedObject structure 的 NativeData field 指定。")]),e._v(" "),a("li",[e._v("OLE2.0 中，Native Data 的指定方式有以下两种，可以互换使用：\n"),a("ul",[a("li",[e._v('由复合文档的以 "\\1Ole10Native" 为名的 stream object 包含。如 OLENativeStream structure 的 NativeData field 所指定。')]),e._v(" "),a("li",[e._v("由 creating application 创建的 stream objects 可以包含 native data。此类流对象是 creating application 的私有对象，未在文档中说明。\n"),a("ul",[a("li",[e._v("creating application: An application whose data is stored in or referenced by documents from other applications.")])])])])])])]),e._v(" "),a("li",[e._v("Embedded Object Presentation Data\n"),a("ul",[a("li",[e._v("用于指定如何在 container application 中显示 linked or embedded object 对象")]),e._v(" "),a("li",[e._v("OLE1.0 中，其由 EmbeddedObject structure 的 Presentation field 指定")]),e._v(" "),a("li",[e._v('OLE2.0 中，由复合文档的以 "\\2OlePres" 为前缀(后跟着3个十进制数字，并且最多只能有999个Presentations)的 stream objects 指定。每一个 stream 都包含一个 OLEPresentationStream structure。')])])])]),e._v(" "),a("h4",{attrs:{id:"_2-宏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-宏"}},[e._v("#")]),e._v(" 2. 宏")]),e._v(" "),a("p",[e._v("常见的 宏 有两种：vba 和 ms-excel4.0, 它们出现的主要位置有：")]),e._v(" "),a("ul",[a("li",[e._v("vba project\n"),a("ul",[a("li",[e._v("office97 ~ 2003: vba project storage")]),e._v(" "),a("li",[e._v("office2007 ~ : vbaProject.bin")])])]),e._v(" "),a("li",[e._v("microsoft office excel 4.0\n"),a("ul",[a("li",[e._v("office97 ~ 2003: book\\workbook stream\n"),a("ul",[a("li",[e._v("注：主要通过 BIFF 格式保存了 formula、drawing group 等内容")])])]),e._v(" "),a("li",[e._v("office2007 ~ : macrosheets\n"),a("ul",[a("li",[e._v("Microsoft 365 新增 "),a("a",{attrs:{href:"https://support.microsoft.com/en-us/office/lambda-function-bd212d27-1cd1-4321-a34a-ccbf254b8b67",target:"_blank",rel:"noopener noreferrer"}},[e._v("LAMBDA function"),a("OutboundLink")],1)])])])])]),e._v(" "),a("li",[e._v("macro template\n"),a("ul",[a("li",[e._v("office2007 ~ : /[xx]/_rels/settings.xml.rels 中引用外部(远程)模板文件")])])]),e._v(" "),a("li",[e._v("VbaProjectStg\n"),a("ul",[a("li",[e._v("binary powerpoint document 中用于指定一个用于 VBA project 的结构化存储")])])])]),e._v(" "),a("h4",{attrs:{id:"_3-officeart"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-officeart"}},[e._v("#")]),e._v(" 3. officeart")]),e._v(" "),a("ul",[a("li",[e._v("office97 ~ 2003:\n"),a("ul",[a("li",[e._v("worddocument、book\\workbook、'powerpoint document' stream\n"),a("ul",[a("li",[e._v("Office Drawing Binary File Format (MS-ODRAW)，This file format is also known as OfficeArt.")])])])])]),e._v(" "),a("li",[e._v("office2007 ~ :\n"),a("ul",[a("li",[a("em",[e._v("TODO")])])])])]),e._v(" "),a("h4",{attrs:{id:"_4-encryption-and-obfuscation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-encryption-and-obfuscation"}},[e._v("#")]),e._v(" 4. encryption and obfuscation")]),e._v(" "),a("p",[e._v("详见 "),a("RouterLink",{attrs:{to:"/blog/skills/office/ole_office_msoffcrypto.html"}},[e._v("Office 格式简析 - Crypto")])],1),e._v(" "),a("p",[e._v("这里需要注意的是 vba project 的保护(待确认)：")]),e._v(" "),a("ul",[a("li",[e._v("vba project\n"),a("ul",[a("li",[e._v("可以对其中的 stream 设置独立的密码 (未确认)\n"),a("ul",[a("li",[e._v("VBA uses a reversible encryption algorithm for selected data.")])])]),e._v(" "),a("li",[e._v("PROJECT Stream: ProjectProtectionState\n"),a("ul",[a("li",[e._v('ProjectProtectionState: "CMG="0705D8E3D8EDDBF1DBF1DBF1DBF1"" specifies no sources are restricted access to the VBA project. The value is obfuscated by Data Encryption (section 2.4.3).')]),e._v(" "),a("li",[e._v('ProjectPassword (section 2.3.1.16): "DPB="0E0CD1ECDFF4E7F5E7F5E7"" specifies the VBA project has no password. The value is obfuscated by Data Encryption (section 2.4.3).')]),e._v(" "),a("li",[e._v('ProjectVisibilityState (section 2.3.1.17): "GC="1517CAF1D6F9D7F9D706"" specifies the VBA project is visible. The value is obfuscated by Data Encryption (section 2.4.3).')]),e._v(" "),a("li",[e._v('LibName: "VBE" specifies a built in name for the VBA Automation type library.')])])])])])]),e._v(" "),a("h3",{attrs:{id:"vba-project-格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vba-project-格式"}},[e._v("#")]),e._v(" VBA Project 格式")]),e._v(" "),a("p",[e._v("VBA project 是由一系列 records 组成的结构。其中每个 record 都定义了 project 的三要素之一的部分内容。每个 record 都是以结构开头："),a("code",[e._v("ID(2 bytes) + Size(4 bytes) + ...")])]),e._v(" "),a("p",[e._v("project 的三要素有：project information, project references, and project items.")]),e._v(" "),a("h4",{attrs:{id:"_1-project-information"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-project-information"}},[e._v("#")]),e._v(" 1. project information")]),e._v(" "),a("p",[e._v("ole 中 VBA 存储(storage)结构如下：")]),e._v(" "),a("p",[a("img",{attrs:{src:r(523),alt:"VBA"}})]),e._v(" "),a("p",[e._v("其中 Project Root Storage 是一个独立的 storage。例如，OLE 文件中的 Macros storage。")]),e._v(" "),a("ul",[a("li",[e._v("VBA Storage\n"),a("ul",[a("li",[e._v("sub-structure\n"),a("ul",[a("li",[e._v("_VBA_PROJECT Stream\n"),a("ul",[a("li",[e._v("MUST")]),e._v(" "),a("li",[e._v("包含了 VBA project 的基础信息，如，版本号(用于加载此结构的剩余内容) 等")])])]),e._v(" "),a("li",[e._v("dir Stream\n"),a("ul",[a("li",[e._v("MUST")]),e._v(" "),a("li",[e._v("指明 VBA project properties, project references, 和 module properties")]),e._v(" "),a("li",[e._v("The entire stream MUST be compressed as specified in Compression")])])]),e._v(" "),a("li",[e._v('"Module Stream"\n'),a("ul",[a("li",[e._v("VBA project 中的每个 module 必须拥有一个 Module Stream")]),e._v(" "),a("li",[e._v("VBA project 中 modules 的源码。此 stream 的名字由 MODULESTREAMNAME 指定。")])])]),e._v(" "),a("li",[e._v("SRP Streams\n"),a("ul",[a("li",[e._v("Optional")]),e._v(" "),a("li",[e._v("指定 特定实现和版本相关 的性能缓存的流。必须是读取时忽略。写入时不得出现。")])])])])])])]),e._v(" "),a("li",[e._v("PROJECT Stream\n"),a("ul",[a("li",[e._v("MUST")]),e._v(" "),a("li",[e._v("VBA Project Properties, 如 工程的目录结构、脚本类型、module的可编辑窗口的信息等等, 以及一些 VBA project 的附加信息，如：ProjectPassword、ProjectVisibilityState 等 "),a("img",{attrs:{src:r(524),alt:"sample_vba_project"}}),e._v(" 注："),a("a",{attrs:{href:""}},[e._v("[MS-OVBA] - v20200219 的 2.3.1.3 ProjectModule")]),e._v(" 有脚本类型的相关说明")])])]),e._v(" "),a("li",[e._v("PROJECTwm Stream\n"),a("ul",[a("li",[e._v("Optional")]),e._v(" "),a("li",[e._v("包含了用于 module name 在 multibyte character set (MBCS) 和 UTF-16 之间互相映射的信息")])])]),e._v(" "),a("li",[e._v("PROJECTlk Stream\n"),a("ul",[a("li",[e._v("Optional")]),e._v(" "),a("li",[e._v("包含了 VBA project 中的 ActiveX controls 的 license 信息")])])]),e._v(" "),a("li",[e._v("Designer Storages\n"),a("ul",[a("li",[e._v("Optional")]),e._v(" "),a("li",[e._v("每个 vba project 中的 designer module 都必定有一个与之对应的 designer storage ，此 storage 的名字由 dir stream 中相关 module 中的 MODULESTREAMNAME record 指定。")]),e._v(" "),a("li",[e._v("每个 designer storage 必定有一个 VBFrame Stream\n"),a("ul",[a("li",[e._v('VBFrame Stream，用于描述 designer module 的属性信息，此 stream 的名字必须是以 UTF-16 character 0x0003 开头紧接着是  UTF-16 的 "VBFrame"。')])])]),e._v(" "),a("li",[e._v("如果此 designer 是一个 Office Form ActiveX control, 那么此 storage 必定包含 "),a("code",[e._v("[MS-OFORMS] section 2")]),e._v("中描述的必须 storages 和 streams。")])])])]),e._v(" "),a("h4",{attrs:{id:"_2-project-references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-project-references"}},[e._v("#")]),e._v(" 2. project references")]),e._v(" "),a("p",[e._v("dir Stream 中的 records 包含了 VBA project 对外部资源引用的信息。主要有三类：REFERENCECONTROL、REFERENCEREGISTERED、REFERENCEPROJECT。")]),e._v(" "),a("h4",{attrs:{id:"_3-project-items"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-project-items"}},[e._v("#")]),e._v(" 3. project items")]),e._v(" "),a("p",[e._v("VBA project 包含一系列用于嵌入 macros 的 project items。而 project item 是由多个 records 组合定义。主要有以下 5 种 project item(详见 MS-OVBA 文档): "),a("code",[e._v("project package, document modules, procedural modules, class modules")]),e._v(" 和 "),a("code",[e._v("designer modules")]),e._v("。")]),e._v(" "),a("h4",{attrs:{id:"_4-pcode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-pcode"}},[e._v("#")]),e._v(" 4. pcode")]),e._v(" "),a("p",[e._v("它并不广为人知，一般来说 VBA 编写的宏以三种不同的可执行形式存在，每种形式都可以是在运行时实际执行的内容，具体取决于具体情况. 它们是：")]),e._v(" "),a("ul",[a("li",[e._v("source code\n"),a("ul",[a("li",[e._v("这是最为我们熟知的形式。但大多数情况下，office 会完全忽略源代码。")]),e._v(" "),a("li",[e._v("事实上，删除源代码是可能的，但宏仍然可以毫无问题地执行(从 pcode)\n"),a("ul",[a("li",[e._v("这种威胁利用技术被称为 VBA Stomping")])])])])]),e._v(" "),a("li",[e._v("p-code\n"),a("ul",[a("li",[e._v("当每行 vba 脚本被输入到 vba 编辑器中时，它会立即被编译成 pcode 并存储到模块流中。 pcode 正是大部分时间被执行的代码。")]),e._v(" "),a("li",[e._v("事实上，即使在 vba 编辑器中打开宏模块的源码，显示的也不是解压后的源码，而是反编译成源码的 pcode。")]),e._v(" "),a("li",[e._v("只有在使用与创建文档时使用的 vba 版本不同的 office 版本下打开文档时，才会将存储的压缩源代码重新编译为 pcode，然后执行该 pcode")]),e._v(" "),a("li",[e._v("这使得可以在支持 vba 的任何版本的 office 上打开包含 vba 的文档，并使内部的宏保持可执行，尽管不同版本的 vba 使用不同(不兼容)的 pcode 指令。")])])]),e._v(" "),a("li",[e._v("dxecodes\n"),a("ul",[a("li",[e._v("当 pcode 至少被执行过一次后，它会以进一步标记化形式存储在文档的其他地方(在流中，其名称以 _"),a("em",[e._v("SRP")]),e._v(" 开头，后跟一个数字)。从那里它可以执行得更快。")]),e._v(" "),a("li",[e._v("但是 execode 的格式极其复杂，并且特定于创建它们的特定 Office 版本(不是 VBA 版本)。这使得它们的通用性很差。")]),e._v(" "),a("li",[e._v("此外，它们的存在不是必需的 --- 它们可以被删除并且宏将运行得很好(从 pcode)")])])])]),e._v(" "),a("p",[e._v("综上，我们可以知道：")]),e._v(" "),a("ul",[a("li",[e._v("source 的通用性最好，但只有在 pcode 不能使用时，才会被使用")]),e._v(" "),a("li",[e._v("execodes 的通用性最差，但执行得最快")]),e._v(" "),a("li",[e._v("p-code 则是执行速度和通用性的折中，也是用的比较广泛的形式")])]),e._v(" "),a("p",[e._v("因此，我们有必要解析 pcode，具体可以参考："),a("a",{attrs:{href:"https://github.com/bontchev/pcodedmp",target:"_blank",rel:"noopener noreferrer"}},[e._v("github.com/bontchev/pcodedmp"),a("OutboundLink")],1)]),e._v(" "),a("h3",{attrs:{id:"microsoft-office-excel-4-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#microsoft-office-excel-4-0"}},[e._v("#")]),e._v(" Microsoft Office Excel 4.0")]),e._v(" "),a("p",[e._v("Microsoft Office Excel 4.0, 主要存在于 MS-XLS 的 book\\workbook stream 中。此 stream 以 BIFF8(Binary Interchange File Format) 格式组织各个细节。")]),e._v(" "),a("p",[e._v("Stream 由以下几部分组成：")]),e._v(" "),a("ul",[a("li",[e._v("Globals Substream\n"),a("ul",[a("li",[e._v("描述 workbook 中的全局属性和数据\n"),a("ul",[a("li",[e._v("注意 Lbl、ShrFmla 数据")])])])])]),e._v(" "),a("li",[e._v("Chart Sheet Substream")]),e._v(" "),a("li",[e._v("Dialog Sheet Substream")]),e._v(" "),a("li",[e._v("Macro Sheet Substream")]),e._v(" "),a("li",[e._v("Worksheet Substream")])]),e._v(" "),a("p",[e._v("使用 Excel 4 Macros 的一些细节：")]),e._v(" "),a("ul",[a("li",[e._v("使用 relative named range 时，函数主体和结果之间的单元格距离必须都相同，否则可能会计算出错误的结果。")]),e._v(" "),a("li",[e._v("Office 2007 ~ 中，任何带有 Excel 4 Macro 的文件都必须另存为启用宏的工作簿 (.xlsm)，尝试另存为标准 Excel 文件将触发以下错误消息:\n"),a("img",{attrs:{src:r(525),alt:"must_save_excel4_as_xlsm"}})]),e._v(" "),a("li",[e._v("任何包含数组的函数，例如 GET.WORKSPACE(37) 或 NAMES() 都应该包含在 INDEX 函数中: 如，=INDEX(GET.WORKSPACE(37),!A1)，在这个例子中，A1 包含应该检索的数组中的数字，例如如果 A1 包含值 2，它将返回 GET.WORKSPACE(37) 数组中的第二项。")]),e._v(" "),a("li",[e._v("使用 Macro Worksheet 时，工作表设置为显示公式，而不是公式的结果。可以使用 "),a("code",[e._v("Ctrl + |")]),e._v(" 在公式视图和结果视图之间切换。")])]),e._v(" "),a("h4",{attrs:{id:"ptgexp、shrfmla、array"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ptgexp、shrfmla、array"}},[e._v("#")]),e._v(" PtgExp、ShrFmla、Array")]),e._v(" "),a("p",[e._v("PtgExp 一般会出现在 formula 的第一个 rgce 元素。此时，它表示当前单元格是 array formula 或 shared formula 的一部分。")]),e._v(" "),a("p",[e._v("PtgExp.row 和 PtgExp.col 指定了一个在当前 sheet 中的 cell")]),e._v(" "),a("ul",[a("li",[e._v("这个 cell 也是 array formula 或 shared formula 的一部分\n"),a("ul",[a("li",[e._v("也就是说必定有一个 formula record 的 row == PtgExp.row && col == PtgExp.col\n"),a("ul",[a("li",[e._v("紧跟着这个 formula record 的必定是一个 ShrFmla record 或者 Array record")]),e._v(" "),a("li",[e._v("也就是说这个 PtgExp 指向了使用此 array formula 或 shared formula 的区域中的 the first cell\n"),a("ul",[a("li",[e._v("隐含：拥有 PtgExp 的 formula record 满足：record.row == PtgExp.row && record.col == PtgExp.col 时，它后边一定跟着 ShrFmla record 或 Array record")])])])])]),e._v(" "),a("li",[e._v("这个 formula record 定义了区域中使用 array formula 或 shared formula 的 the first cell")])])])]),e._v(" "),a("p",[e._v("ShrFmla(shared formula record)")]),e._v(" "),a("ul",[a("li",[e._v("此 record 前必定有一个 formula record，这个 formula record 指定了使用此 shared formula 的区域中的 the first cell")]),e._v(" "),a("li",[e._v("其它使用了此 shared formula 的 formula records 后续会出现，但不一定是连续的")]),e._v(" "),a("li",[e._v("使用了此 shared formula 的 formula records 会有 Formula.fShrFmla bit 被置位，同时 Formula.cell 必定位于 ShrFmla.ref 指定的区域内")])]),e._v(" "),a("p",[e._v("Array(array formula record)")]),e._v(" "),a("ul",[a("li",[e._v("此 record 前必定有一个 Formula record，这个 formula record 指定了使用此 array formula 的区域中的 the first cell")]),e._v(" "),a("li",[e._v("其它使用了此 array formula 的 formula records 后续会出现，但不一定是连续的")]),e._v(" "),a("li",[e._v("使用了此 array formula 的 formula records 必定有 Formula.cell 位于 Array.ref 指定的区域内，同时这些使用 array formula 的 formula 的 rgce 必定以 PtgExp 开头。")])]),e._v(" "),a("h4",{attrs:{id:"解析过程中遇到的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解析过程中遇到的问题"}},[e._v("#")]),e._v(" 解析过程中遇到的问题")]),e._v(" "),a("ul",[a("li",[e._v("RgceLoc 可以按照 RgceLocRel 来解析，以简化解析流程。")]),e._v(" "),a("li",[e._v('解析 formula 的过程中，会遇到 "is part of a revision or not" 的分支流程，这里涉及以下三个概念：\n'),a("ul",[a("li",[e._v("UserBView Record:\n"),a("ul",[a("li",[e._v("fPersonalView : MUST be 0 if this is not a shared workbook.")])])]),e._v(" "),a("li",[e._v("Revision Stream\n"),a("ul",[a("li",[e._v("An instance of the Revision Stream specifies the revision logs (section 2.2.11.2) and revision records (section 2.2.11.3) for a shared workbook (section 2.2.11).")]),e._v(" "),a("li",[e._v('The name of this stream MUST be "Revision Log". A file MUST contain at most one Revision Stream. The Revision Stream MUST exist if the workbook is a shared workbook.')])])]),e._v(" "),a("li",[e._v("Revision Records\n"),a("ul",[a("li",[e._v("a series of records. 详情可以参考 [MS-XLS] 文档。")])])])])]),e._v(" "),a("li",[e._v("external references：\n"),a("ul",[a("li",[e._v("Supporting Link 包含了 Self-Referencing、Same-Sheet Referencing、External Workbook Referencing 等等类型。")])])]),e._v(" "),a("li",[e._v("name manager:\n"),a("ul",[a("li",[e._v("LblRecord : (关联 name 和 sheet)\n"),a("ul",[a("li",[e._v("内置名字的索引，可能由 1 或 2 字节表示")]),e._v(" "),a("li",[e._v("NameParsedFormula 可能出现 ptgRef3d 的 ixti == 0xFFFF，此时，此时的结构未被文档记录：\n"),a("ul",[a("li",[e._v("we can reproduce it: make a macro sheet in ooxml and export it to xls.")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("  \t\tuint8_t ptg = uint8_t(data[cce_offset] & 0x7f);\n  \t\tif (ptg == ptgRef3d || ptg == ptgRef3dA || ptg == ptgRef3dV) {\n  \t\t\tuint16_t ixti = *(uint16_t*)(data + cce_offset + 1);\n  \t\t\tif (ixti > 0xFF00 && record->cce >= 15 + 3) {\n  \t\t\t\tassert(record->itab == 0 || record->itab == 1);\n      uint16_t iscope_1base = (record->itab == 1) ? record->reserved1 : record->itab;\n  \t\t\t\tuint16_t isheet_0base_a = *(uint16_t*)(data + cce_offset + 11);\n  \t\t\t\tuint16_t isheet_0base_b = *(uint16_t*)(data + cce_offset + 13);\n  \t\t\t\tassert(isheet_0base_a == isheet_0base_b);\n  \t\t\t\tauto row = *(uint16_t*)(data + cce_offset + 15);\n  \t\t\t\tauto col = (uint16_t)*(uint8_t*)(data + cce_offset + 17);\n  \t\t\t}\n  \t\t}\n  \t}\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br")])])])])])])]),e._v(" "),a("li",[e._v("Rgce 的 ACTUAL_PTG_SIZE 跟实际情况不符合")])]),e._v(" "),a("h3",{attrs:{id:"doc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#doc"}},[e._v("#")]),e._v(" DOC")]),e._v(" "),a("p",[e._v("一个 doc 文档应当由以下几个部分组成：")]),e._v(" "),a("ol",[a("li",[e._v("WordDocument stream\n"),a("ul",[a("li",[e._v("有一个 FIB structure 在流的起始位置")])])]),e._v(" "),a("li",[e._v("Table stream\n"),a("ul",[a("li",[e._v("1Table 或者 0Table 流必定存在。当二者同时存在时，base.fWhichTblStm 指定的为有效流，忽略其他即可。")]),e._v(" "),a("li",[e._v("如果文档被加密的话，会有一个 EncryptionHeader 结构在流的起始位置。反之，如果文档没有加密，则此流没有预定义的结构。")]),e._v(" "),a("li",[e._v("存储了文档的文本信息")])])]),e._v(" "),a("li",[e._v("Data stream\n"),a("ul",[a("li",[e._v("没有预定义的结构，也不是必定存在。它包含的是 FIB 或 文件的其它部分的引用数据，也就是说如果没有引用数据的话，这个流没有存在的必要")])])]),e._v(" "),a("li",[e._v("ObjectPool storage\n"),a("ul",[a("li",[e._v("Object Pool storage 包含一些用于持久化 embedded OLE objects 的 storages。如果文档没有 embedded OLE objects 时，是不会出现此 storage 的。")]),e._v(" "),a("li",[e._v('每一个位于 ObjectPool storage 中的 storage 都有一个 ObjInfo Stream (名为 "\\003ObjInfo")，这个流里存放着用于描述 embedded OLE object 信息的 ODT structure。\n'),a("ul",[a("li",[e._v("embedded OLE object 相关的其他流的描述可以参考 "),a("a",{attrs:{href:""}},[e._v("Embedded Object Native Data")]),e._v(" 相关内容")])])]),e._v(" "),a("li",[e._v('每个 sub-storage 都存储了一个用户嵌入(embedded)的文件。并且，每个 sub-storage 都是以: 下划线"_" + 10个digits 组成，如 _1557814583\n'),a("ul",[a("li",[e._v("关联引用的关键词：sprmCFOle2、sprmCPicLocation")])])])])]),e._v(" "),a("li",[e._v("Summary Information\n"),a("ul",[a("li",[e._v("Summary Information stream")]),e._v(" "),a("li",[e._v("Document Summary Information stream")]),e._v(" "),a("li",[e._v("Encrypt stream\n"),a("ul",[a("li",[e._v("名为 encryption 的流，只有当以下两个条件同时满足才会出现：文档被 RC4 CryptoAPI 加密， 并且，EncryptionHeader.Flags 的 fDocProps 标记被置位")])])])])]),e._v(" "),a("li",[e._v("Macros stream\n"),a("ul",[a("li",[e._v("vba project")])])]),e._v(" "),a("li",[e._v("Signature\n"),a("ul",[a("li",[e._v("参考 "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/2770c801-5f0f-4326-89e8-d6ef15b68ef1",target:"_blank",rel:"noopener noreferrer"}},[e._v("MS-OFFCRYPTO"),a("OutboundLink")],1),e._v(" 中的说明。")])])]),e._v(" "),a("li",[e._v("Protected Content")])]),e._v(" "),a("ul",[a("li",[e._v("由 IRMDS 描述的方式进行保护的内容, 在 "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/278b0e42-9080-48fc-806f-7d4f6b264fb0",target:"_blank",rel:"noopener noreferrer"}},[e._v("MS-OFFCRYPTO"),a("OutboundLink")],1),e._v(" 有描述。")])]),e._v(" "),a("h3",{attrs:{id:"ppt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ppt"}},[e._v("#")]),e._v(" PPT")]),e._v(" "),a("p",[e._v("按照 [MS-PPT] - v20210817 ：pageno 28 中 Part 1 ~ 11 的描述，即可解出完整的 ppt 文档内容。")]),e._v(" "),a("p",[e._v("注意：the UserEditAtom record closest to the end of the PointPower Document stream")]),e._v(" "),a("p",[e._v('其中，所有用于 presentation 的文本都存储在 "PowerPoint Document" stream 中；所有用于 presentation 的 images 都存储在Pictures stream 中；不过，Embedded files 没有存储在独立的 storages，而是被融合到 "PowerPoint Document" stream 中，此外，这些 embedded files 在存储时，有些会被压缩有些却不会。')]),e._v(" "),a("h4",{attrs:{id:"external-objects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#external-objects"}},[e._v("#")]),e._v(" External Objects")]),e._v(" "),a("p",[e._v("Slides 可以包含连接到外部的 objects。播放 ppt 的人可以在幻灯片放映期间激活链接对象以访问外部资源。External Objects 的例子有 embedded and linked audio, linked video, embedded and linked OLE objects, 以及 hyperlinks。")]),e._v(" "),a("p",[e._v("也就是说 Embedded or Linked Object 在 ppt 中的存在形式就是 External Objects。")]),e._v(" "),a("p",[e._v("有关有 External Objects 的记录，请参阅 "),a("a",{attrs:{href:""}},[e._v("[MS-PPT] External Object Types (section 2.10)")]),e._v(" 相关内容。简单的说，为了解析出 External Objects，我们需要关注：")]),e._v(" "),a("ul",[a("li",[e._v("ExternalOleObjectStg 0x1011 , 用于对象存储(如果有n个则会有n个此类型的 record)")]),e._v(" "),a("li",[e._v("DocumentContainer 0x03E8 , 用于描述文档对象\n"),a("ul",[a("li",[e._v("DocInfoListContainer 0x07D0\n"),a("ul",[a("li",[e._v("VBAInfoContainer 0x03FF\n"),a("ul",[a("li",[e._v("VBAInfoAtom  0x0400")])])])])]),e._v(" "),a("li",[e._v("ExObjListContainer 0x0409\n"),a("ul",[a("li",[e._v("storage for compressed/uncompressed OLE/VBA/ActiveX control data, 如 VbaProjectStg")])])]),e._v(" "),a("li",[e._v("SoundCollectionContainer")]),e._v(" "),a("li",[e._v("DrawingGroupContainer")])])])]),e._v(" "),a("p",[e._v("也就是说要首先找到 DocumentContainer：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("1. 构造 PersistDirectory\n  Current User Stream\n    CurrentUserAtom Record\n      offsetToCurrentEdit field\n  |--\x3ePowerPoint Document Stream\n  |\t\tUserEditAtom\n  |\t\t\toffsetPersistDirectory field\n  |\t\tPersistDirectoryAtom\n  UserEditAtom.offsetLastEdit (Repeat until offsetLastEdit is 0x000000)\n\n2. 定位 DocumentContainer\n  UserEditAtom.docPersistIdRef\n    DocumentContainer Record\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br")])]),a("p",[e._v("关于鉴别 embedded OLE object 对象的具体步骤可以参考 "),a("a",{attrs:{href:""}},[e._v("[MS-PPT] 2.1.2 PowerPoint Document Stream  part 9")]),e._v(" 相关内容")]),e._v(" "),a("p",[e._v("关于鉴别 linked OLE object 对象的具体步骤可以参考 "),a("a",{attrs:{href:""}},[e._v("[MS-PPT] 2.1.2 PowerPoint Document Stream  part 10")]),e._v(" 相关内容")]),e._v(" "),a("h3",{attrs:{id:"xls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xls"}},[e._v("#")]),e._v(" XLS")]),e._v(" "),a("p",[e._v("一个 xls 文件最多只能一个 Component Object Stream。\n一个 xls 文件最多只能一个 OLE Stream。\n一个 xls 文件最多只能一个 Control Stream。")]),e._v(" "),a("p",[e._v("WorkBook stream 中存储了 excel 中所有的 text 和 formulas。")]),e._v(" "),a("h4",{attrs:{id:"embedded-or-linked-object"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#embedded-or-linked-object"}},[e._v("#")]),e._v(" Embedded or Linked Object")]),e._v(" "),a("p",[e._v('在 Excel 的 workbook 中嵌入一个文件的话，这些文件会被存储在名为 "MBD + 随机的8个十六进制数字" 的 Embedding Storages 中。')]),e._v(" "),a("p",[e._v("每个 Embedding Storage 都表示了一个基于 storage-based 持久化的 embedded OLE object 或 ActiveX control 对象。同时，持久化在 Embedding Storage 的对象必定有一个相关联的 Obj record 在 worksheet substream、macro sheet substream 或 dialog sheet substream 中，并且 cmo.ot == 8，pictFlags.fPrstm == pictFlags.fDde == 0。")]),e._v(" "),a("p",[e._v("不过不同类型的文件在 Embedding Storage 中的形式有些不一样，如：")]),e._v(" "),a("ol",[a("li",[e._v("如果 embedded file 是另外一个 binary Office document, 那么这个 embedded file 中的 storages 和 streams 会被当成对应的节点原样存储在 MDB storage 中")]),e._v(" "),a("li",[e._v('如果 embedded file 是一个 Open XML document, 那么这个 embedded file 会被完整存储在名为 "Package" 的 stream 中')])]),e._v(" "),a("p",[e._v('一个 Link Storage 指定一个 linked OLE object 和任意其他的默认数据或表示为其建立的缓存。它的名字必定是由："LNK" + 8个十六进制数字 标识。持久化在 Link Storage 的对象必定有一个相关联的 Obj record (Obj.pictFmla.lPosInCtlStm)在 worksheet substream、macro sheet substream 或 dialog sheet substream 中，并且 cmo.ot == 8，pictFlags.fPrstm == pictFlags.fDde == 0。')]),e._v(" "),a("h2",{attrs:{id:"ooxml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ooxml"}},[e._v("#")]),e._v(" OOXML")]),e._v(" "),a("p",[e._v("OOXML(Office Open XML File Formats), 简单来说，OOXML 是一个基于 XML 的文档格式标准，最早是微软 Office2007 的产品开发技术规范，先是成为 Ecma(ECMA-376) 的标准，最后改进推广成为了 ISO 和 IEC (as ISO/IEC 29500) 的国际文档格式标准。也就是说，通过 OOXML 标准，我们能够在不依赖 Office 产品的情况下，在任何平台读写Office Word，PPT 和 Excel 文件。")]),e._v(" "),a("p",[e._v("OOXML 的主要目录结构如下所示：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("OOXML\n├── [Content_Types].xml // 描述文档各个部分的ContentType，协助解析文档\n│           \n├─ docProps        // ms-office 需要此内容以打开文件，而 wps 不需要\n│   ├── app.xml    //程序级别的文档属性，如：页数、文本行数、程序版本等\n│   └── core.xml   //用户填写的文档属性，如：标题、主题、作者等\n│\n├─ _rels\n│   └── .rels      //描述各个部分之间的关系\n│\n└─ word / xl / ppt\n    ├── document.xml     //word\n    ├── fontTable.xml    //word，页脚\n    │\n    ├── workbook.xml     // xl\n    ├── worksheets       // xl\n    │    └── sheet1.xml\n    ├── macrosheets      // xl, microsoft excel 4.0 macros\n    │      ├── _rels\n    │      │   └── sheet1.xml.rels\n    │      └── sheet1.xml\n    |\n    |── presentation.xml // ppt\n    |\n    |── embeddings       //all, optional, 存放 embedded files\n    |     ├── a\n    |     └── b\n    │\n    |── vbaData.xml      //all, vba属性，是否auoopen，是否加密\n    |── vbaProject.bin   //all, 记录 vba project 信息, ole 格式\n    |\n    ├─ theme             //all, 记录样式，颜色编号，字体大小等等\n    │    └── theme1.xml\n    │\n    ├─ _rels             //all, relationships\n    |    ├── settings.xml.rels   // 指定 模板 引用\n    │    ├── document.xml.rels   // 使用 ID 和 URL 来定义文档各零件\n    |    ├── workbook.xml.rels   // 使用 ID 和 URL 来定义文档各零件\n    │    └── vbaProject.bin.rels // vba\n    │ \n    ├── printerSettings //all, Reference to Printer Settings Data\n    │....└── printerSettings1.bin\n    │\n    └─ styles.xml       //all\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br"),a("span",{staticClass:"line-number"},[e._v("23")]),a("br"),a("span",{staticClass:"line-number"},[e._v("24")]),a("br"),a("span",{staticClass:"line-number"},[e._v("25")]),a("br"),a("span",{staticClass:"line-number"},[e._v("26")]),a("br"),a("span",{staticClass:"line-number"},[e._v("27")]),a("br"),a("span",{staticClass:"line-number"},[e._v("28")]),a("br"),a("span",{staticClass:"line-number"},[e._v("29")]),a("br"),a("span",{staticClass:"line-number"},[e._v("30")]),a("br"),a("span",{staticClass:"line-number"},[e._v("31")]),a("br"),a("span",{staticClass:"line-number"},[e._v("32")]),a("br"),a("span",{staticClass:"line-number"},[e._v("33")]),a("br"),a("span",{staticClass:"line-number"},[e._v("34")]),a("br"),a("span",{staticClass:"line-number"},[e._v("35")]),a("br"),a("span",{staticClass:"line-number"},[e._v("36")]),a("br"),a("span",{staticClass:"line-number"},[e._v("37")]),a("br"),a("span",{staticClass:"line-number"},[e._v("38")]),a("br"),a("span",{staticClass:"line-number"},[e._v("39")]),a("br"),a("span",{staticClass:"line-number"},[e._v("40")]),a("br"),a("span",{staticClass:"line-number"},[e._v("41")]),a("br"),a("span",{staticClass:"line-number"},[e._v("42")]),a("br"),a("span",{staticClass:"line-number"},[e._v("43")]),a("br"),a("span",{staticClass:"line-number"},[e._v("44")]),a("br")])]),a("h3",{attrs:{id:"_1-name-representation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-name-representation"}},[e._v("#")]),e._v(" 1. Name Representation")]),e._v(" "),a("p",[e._v("无论是 definedNames 中定义的，还是表格显示的名字，这些需要展示的名字都应当在 "),a("code",[e._v("docProps\\app.xml")]),e._v(" 中作为 Application-Defined File Properties 部分被定义，如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<TitlesOfParts>\n <vt:vector size="[0-9]+" baseType="lpstr">\n  <vt:lpstr>Sheet1</vt:lpstr>\n  <vt:lpstr>Sheet2</vt:lpstr>\n  <vt:lpstr>Sheet3</vt:lpstr>\n  <vt:lpstr>value1</vt:lpstr>\n  <vt:lpstr>value2</vt:lpstr>\n </vt:vector>\n</TitlesOfParts>\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("h3",{attrs:{id:"_2-cell-references-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-cell-references-name"}},[e._v("#")]),e._v(" 2. Cell References & Name")]),e._v(" "),a("p",[e._v("excel中可以给 函数、cell、sheet、甚至任意一段文本或图形等定义名字(也被称为 bookmark)，并通过名字来引用对应的内容，引用方式参考")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:""}},[e._v("ECMA-376-Fifth-Edition-Part-1 --- 18.17.2.3 Cell References")])]),e._v(" "),a("li",[a("a",{attrs:{href:""}},[e._v("ECMA-376-Fifth-Edition-Part-1 --- 18.17.2.5 Names ")])])]),e._v(" "),a("p",[e._v("name 的组成形式：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('name = [ workbook-name, "!" ], [letter | "_" | "\\"], [ letter | decimal-digit | "_" | "." ] ;\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("其中 name 不能包含以下几种格形式：")]),e._v(" "),a("ul",[a("li",[e._v("TRUE or FALSE")]),e._v(" "),a("li",[e._v("user-defined-function-name")]),e._v(" "),a("li",[e._v("cell-reference")])]),e._v(" "),a("p",[e._v("function-name 的组成形式：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('function-name= prefixed-function-name | predefined-function-name | user-defined-function-name ;\n\npredefined-function-name= "ABS" | "ACOS" | "ACOSH" | ( any of the other functions defined in §18.17.7) ;\nprefixed-function-name= "ISO.", predefined-function-name | "ECMA.", predefined-function-name ; \nuser-defined-function-name= letter, [ letter | decimal-digit | "." ] ;\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("p",[e._v("其中 function-name 不能包含以下几种格形式：")]),e._v(" "),a("ul",[a("li",[e._v("TRUE or FALSE")]),e._v(" "),a("li",[e._v("name")]),e._v(" "),a("li",[e._v("cell-reference")])]),e._v(" "),a("p",[e._v("Cell Reference 的形式有两种：R1C1-Style 和 A1-Style")]),e._v(" "),a("p",[e._v("operator 有以下几种格式：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('":" | comma | space | "^" | "*" | "/" | "+" | "-" | "&" | "=" | "<>" | "<" | "<=" | ">" | ">=" | "%" ;\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-formulas-and-expressions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-formulas-and-expressions"}},[e._v("#")]),e._v(" 3. Formulas and expressions")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:""}},[e._v("ECMA-376-Fifth-Edition-Part-1 --- 17.16.3 Formulas and expressions")])])]),e._v(" "),a("p",[e._v("A field instruction can involve a calculation via a formula, which is simply an expression that is an arbitrary complex arithmetic expression，如：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<sheetData>\n\t\t<row r=\"2\" spans=\"4:4\" x14ac:dyDescent=\"0.25\">\n\t\t\t<c r=\"D2\" s=\"1\" t=\"b\">\n\t\t\t\t<f>FORMULA()=FORMULA()=FORMULA('Buk1'!E11,'Buk2'!B12)=FORMULA('Buk2'!H5,'Buk3'!H3)=FORMULA('Buk3'!C9,'Buk4'!C2)=FORMULA('Buk4'!I8,'Buk5'!F2)=FORMULA('Buk5'!B12,'Buk6'!B10)=FORMULA('Buk6'!G3,'Buk7'!I2)=FORMULA('Buk7'!D13,'Buk1'!A3)=FORMULA('Buk3'!H3&amp;'Ss1'!O6&amp;'Ss1'!D16&amp;'Ss1'!K13&amp;'Ss1'!R12&amp;'Ss1'!R14,D3)=FORMULA('Buk3'!H3&amp;'Buk7'!I2&amp;'Buk4'!C2&amp;'Buk5'!F2&amp;'Buk5'!F2&amp;Ss1br2!B3&amp;'Buk1'!A3&amp;Ss1br2!D5&amp;'Buk6'!B10&amp;Ss1br2!G3&amp;'Buk7'!I2&amp;'Buk7'!I2&amp;Ss1br2!B9,D17)</f>\n\t\t\t\t<v>1</v>\n\t\t\t</c>\n\t\t</row>\n\t</sheetData>\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br")])]),a("h2",{attrs:{id:"ms-office-的其他形式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ms-office-的其他形式"}},[e._v("#")]),e._v(" MS-Office 的其他形式")]),e._v(" "),a("p",[e._v('使用 MS-Office 软件可以将 office 文件通过"另存为"保存为 xml、mhtml、html 等格式的文本文件，并且，可以再次通过 MS-Office 软件打开、编辑。')]),e._v(" "),a("p",[e._v("另外，这些转换而成的文本类型的文档，被加密后，是一个 ole 文件。")]),e._v(" "),a("p",[e._v('被转换而成的 xml 文件，在结构上保持了跟 binary 形式的 office 文件一致，并且一一对应。如，contentType 为 "application/vnd.ms-office.vbaProject" 的 binaryData 数据, 就是二进制形式的 vbaProject 内容 base64 后的结果。')]),e._v(" "),a("p",[e._v("这里要注意的是，在解析 binData 类型的数据时，可能会遇到 mso(ActiveMine) 文件。这是一种文件名为 *.mso 同时 MIME Types 为 application/x-mso 的结构未公开的文件格式(参考\n"),a("a",{attrs:{href:"https://github.com/idiom/activemime-format",target:"_blank",rel:"noopener noreferrer"}},[e._v("activemime-format"),a("OutboundLink")],1),e._v(" )。")]),e._v(" "),a("p",[e._v("MSO文件是将Microsoft Office文档保存为网页时创建的宏引用文件。它包含有关原始文件中包含的宏和OLE（对象链接和嵌入）对象的信息，并且可以被创建的网页作为样式表引用。MSO文件可以用文本编辑器查看，但由于内容是编码的，因此无法读取。大多数用户只会将MSO文件作为电子邮件的附件。")]),e._v(" "),a("h2",{attrs:{id:"rtf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rtf"}},[e._v("#")]),e._v(" RTF")]),e._v(" "),a("p",[e._v("富文本格式（Rtf，rich text tormat）是微软的文本和图像信息交换指定的格式。Rtf文件可以划分为文件头和文档区两个部分组成。文件头和文档区由文本、控制字和控制符组成，同时利用{…}来表明层级关系。")]),e._v(" "),a("h3",{attrs:{id:"检出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检出"}},[e._v("#")]),e._v(" 检出")]),e._v(" "),a("ul",[a("li",[e._v("hash (忽略大小写、空字符)\n"),a("ul",[a("li",[e._v("function")]),e._v(" "),a("li",[e._v("stream")])])]),e._v(" "),a("li",[e._v("模糊匹配\n"),a("ul",[a("li",[e._v("简单的模式匹配")]),e._v(" "),a("li",[e._v("eg.\n"),a("ul",[a("li",[e._v("搜索到 ：VirtualProtectEx、WriteProcessMemory、CreateRemoteThread、VirtualAllocEx")]),e._v(" "),a("li",[e._v('Shell Environ$("comspec") & " /c attrib -S -h """ & Application.StartupPath & "\\K4.XLS""", vbMinimizedFocus')]),e._v(" "),a("li",[e._v('Shell ("\\jdq\\cc$\\b.exe")')]),e._v(" "),a("li",[e._v('If .Lines(1, 1) = "APMP" & .Lines(1, 2) <> "KILL" Then ........ End If')]),e._v(" "),a("li",[e._v("混淆的文件：熵 ？")])])])])])]),e._v(" "),a("h3",{attrs:{id:"清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清理"}},[e._v("#")]),e._v(" 清理")]),e._v(" "),a("ul",[a("li",[e._v("抹除\n"),a("ul",[a("li",[e._v("function\n"),a("ul",[a("li",[e._v("替换函数内容为空格")])])]),e._v(" "),a("li",[e._v("stream :\n"),a("ul",[a("li",[e._v("将 stream 的 size 置 0，同时抹除第一个扇区内容，断开内容扇区链")]),e._v(" "),a("li",[e._v("一般来说，只修改 size 就可以让 office 软件无法读取相关内容。但其他杀软可能会继续报毒，毕竟 stream 的其他信息依然有效，可以在容错情况下还原出来 malicious 内容。")]),e._v(" "),a("li",[e._v("注意：其它部分对 macro 的引用，如：\n"),a("ul",[a("li",[e._v("doc 中 fcCmds 会通过 macro names 引用对应的宏，所以\n"),a("ol",[a("li",[e._v("根据需要将 document 流中的 fcCmds 和 lcbCmds 所引用的数据")]),e._v(" "),a("li",[e._v("粗暴的将 document 流中的 fcCmds 和 lcbCmds 都置空")])])])])])])])])]),e._v(" "),a("li",[e._v("还原\n"),a("ul",[a("li",[e._v("还原被加密破坏的文件内容\n"),a("ul",[a("li",[e._v("病毒感染时是有机会操作原有的正常 vba 脚本的，比如，加密（目前还没见到此类样本）。")])])])])])]),e._v(" "),a("h2",{attrs:{id:"reference"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[e._v("#")]),e._v(" Reference")]),e._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/deployoffice/compat/office-file-format-reference",target:"_blank",rel:"noopener noreferrer"}},[e._v("MS-Office-Extensions"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offfflp/8aea05e3-8c1e-4a9a-9614-31f71e679456",target:"_blank",rel:"noopener noreferrer"}},[e._v("MS-Office File Formats"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-ovba/575462ba-bf67-4190-9fac-c275523c75fc",target:"_blank",rel:"noopener noreferrer"}},[e._v("[MS-OVBA] - v20210817"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/3c34d72a-1a61-4b52-a893-196f9157f083",target:"_blank",rel:"noopener noreferrer"}},[e._v("[MS-OFFCRYPTO] - v20210817"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/cd03cb5f-ca02-4934-a391-bb674cb8aa06",target:"_blank",rel:"noopener noreferrer"}},[e._v("[MS-XLS] - v20210817"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-doc/ccd7b486-7881-484c-a137-51170af7cc22",target:"_blank",rel:"noopener noreferrer"}},[e._v("[MS-DOC] - v20210817"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-ppt/6be79dde-33c1-4c1b-8ccc-4b2301c08662",target:"_blank",rel:"noopener noreferrer"}},[e._v("[MS-PPT] - v20210817"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/85583d21-c1cf-4afe-a35f-d6701c5fbb6f",target:"_blank",rel:"noopener noreferrer"}},[e._v("[MS-OLEDS] - v20210625"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/previous-versions/office/developer/office-2007/aa338205(v=office.12)",target:"_blank",rel:"noopener noreferrer"}},[e._v("Introducing the Office (2007) Open XML File Formats"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"http://download.microsoft.com/download/5/0/1/501ED102-E53F-4CE0-AA6B-B0F93629DDC6/Office/Excel97-2007BinaryFileFormat(xls)Specification.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("Microsoft Office Excel 97 - 2007 Binary File Format (.xls) Specification"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/fdc5e702-d09e-4344-a77f-eb079d41f23f",target:"_blank",rel:"noopener noreferrer"}},[e._v("OLE1.0 and OLE2.0 Formats"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:""}},[e._v("Microsoft Office Word 2003")])]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/previous-versions/office/aa203677(v=office.11)?redirectedfrom=MSDN",target:"_blank",rel:"noopener noreferrer"}},[e._v("Microsoft Office Word 2003 Preview"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/archive/msdn-magazine/2003/november/the-xml-files-xml-in-microsoft-office-word-2003",target:"_blank",rel:"noopener noreferrer"}},[e._v("The XML Files: XML in Microsoft Office Word 2003"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://bbs.pediy.com/thread-218941.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("[翻译]攻击互通性-以OLE为例"),a("OutboundLink")],1)]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.blackhat.com/docs/us-15/materials/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("Attacking Interoperability: An OLE Edition"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://bbs.ichunqiu.com/thread-35164-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("宏病毒常用的一些trick"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://outflank.nl/blog/2018/10/06/old-school-evil-excel-4-0-macros-xlm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Old school: evil Excel 4.0 macros (XLM)"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://github.com/decalage2/oletools/tree/master/oletools",target:"_blank",rel:"noopener noreferrer"}},[e._v("oletools"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[e._v("DidierStevens")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.didierstevens.com/programs/oledump-py/",target:"_blank",rel:"noopener noreferrer"}},[e._v("oledump-py"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py",target:"_blank",rel:"noopener noreferrer"}},[e._v("oledump.py"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://blog.didierstevens.com/2020/03/31/update-msoffcrypto-crack-py-version-0-0-5/",target:"_blank",rel:"noopener noreferrer"}},[e._v("msoffcrypto-crack.py"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[e._v("0xevilc0de")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://0xevilc0de.com/maldoc-uses-template-injection-for-macro-execution/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Maldoc uses template injection for macro execution"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://0xevilc0de.com/excel-4-macros-get-workspace-reference/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Excel 4 Macros – Get.Workspace Reference"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://0xevilc0de.com/removing-passwords-from-vba-projects/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Removing Passwords from VBA Projects"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://0xevilc0de.com/maldoc-uses-rc4-to-hide-powershell-script-retrieves-payload-from-dns-txt-record/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Maldoc uses RC4 to hide PowerShell script, retrieves payload from DNS TXT record"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://0xevilc0de.com/maldoc-uses-windows-api-to-perform-process-hollowing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Maldoc uses Windows API to perform process hollowing"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[e._v("jstrosch")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/jstrosch/malware-samples",target:"_blank",rel:"noopener noreferrer"}},[e._v("malware-samples"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[e._v("spiderlabs")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/",target:"_blank",rel:"noopener noreferrer"}},[e._v("spiderlabs-blog"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://sevrosecurity.com/2019/09/12/dynamic-office-template-injection-for-sandbox-bypass/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Template Injection"),a("OutboundLink")],1)]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/jstrosch/malware-samples/tree/master/maldocs/unknown/2020/May",target:"_blank",rel:"noopener noreferrer"}},[e._v("malware-samples: Word Doc uses Template Injection"),a("OutboundLink")],1)])])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/AspDotNetMVC/p/3810839.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("复合文档文件格式研究"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://blogs.vmware.com/networkvirtualization/2020/11/velvetsweatshop-when-default-passwords-can-still-make-a-difference.html/",target:"_blank",rel:"noopener noreferrer"}},[e._v("VelvetSweatshop: Default Passwords Can Still Make a Difference"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://docs.remnux.org/discover-the-tools/analyze+documents",target:"_blank",rel:"noopener noreferrer"}},[e._v("REMnux: Analyze Documents"),a("OutboundLink")],1)])])])])}),[],!1,null,null,null);t.default=s.exports}}]);
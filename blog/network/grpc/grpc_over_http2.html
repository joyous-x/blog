<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>gRPC over HTTP2</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/img/favicon.ico">
    <meta name="description" content="gRPC over HTTP2">
    <meta name="keywords" content="博客,全栈,技术文档,学习,面试,Go,C/C++,Python,Markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/blog/assets/css/0.styles.852bfa04.css" as="style"><link rel="preload" href="/blog/assets/js/app.a3f4fb79.js" as="script"><link rel="preload" href="/blog/assets/js/3.43c8fac8.js" as="script"><link rel="preload" href="/blog/assets/js/61.2162cd41.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.15b1c6a1.js"><link rel="prefetch" href="/blog/assets/js/100.0d652a05.js"><link rel="prefetch" href="/blog/assets/js/101.8bd14646.js"><link rel="prefetch" href="/blog/assets/js/102.c7d069f7.js"><link rel="prefetch" href="/blog/assets/js/103.935632fa.js"><link rel="prefetch" href="/blog/assets/js/104.48c5f7cb.js"><link rel="prefetch" href="/blog/assets/js/105.a0a8d095.js"><link rel="prefetch" href="/blog/assets/js/106.e17a2373.js"><link rel="prefetch" href="/blog/assets/js/107.a5d6c2b8.js"><link rel="prefetch" href="/blog/assets/js/11.8664c945.js"><link rel="prefetch" href="/blog/assets/js/12.ce8f829f.js"><link rel="prefetch" href="/blog/assets/js/13.ec96994d.js"><link rel="prefetch" href="/blog/assets/js/14.8a40b7ae.js"><link rel="prefetch" href="/blog/assets/js/15.14324128.js"><link rel="prefetch" href="/blog/assets/js/16.ffe9b698.js"><link rel="prefetch" href="/blog/assets/js/17.d3e801ea.js"><link rel="prefetch" href="/blog/assets/js/18.27a776d1.js"><link rel="prefetch" href="/blog/assets/js/19.c794e60e.js"><link rel="prefetch" href="/blog/assets/js/2.9d17c378.js"><link rel="prefetch" href="/blog/assets/js/20.55ee63e2.js"><link rel="prefetch" href="/blog/assets/js/21.3cb77b6e.js"><link rel="prefetch" href="/blog/assets/js/22.8add7339.js"><link rel="prefetch" href="/blog/assets/js/23.4e3ee1b3.js"><link rel="prefetch" href="/blog/assets/js/24.15cdaf17.js"><link rel="prefetch" href="/blog/assets/js/25.fff1e3d7.js"><link rel="prefetch" href="/blog/assets/js/26.a68fecdd.js"><link rel="prefetch" href="/blog/assets/js/27.71115304.js"><link rel="prefetch" href="/blog/assets/js/28.67bc83bf.js"><link rel="prefetch" href="/blog/assets/js/29.ee6fa1e0.js"><link rel="prefetch" href="/blog/assets/js/30.26552b07.js"><link rel="prefetch" href="/blog/assets/js/31.eb3fce00.js"><link rel="prefetch" href="/blog/assets/js/32.cbec33c6.js"><link rel="prefetch" href="/blog/assets/js/33.29e8369b.js"><link rel="prefetch" href="/blog/assets/js/34.2b3a2cc6.js"><link rel="prefetch" href="/blog/assets/js/35.fbbcd62d.js"><link rel="prefetch" href="/blog/assets/js/36.375ab7ea.js"><link rel="prefetch" href="/blog/assets/js/37.f18da370.js"><link rel="prefetch" href="/blog/assets/js/38.93cdea6a.js"><link rel="prefetch" href="/blog/assets/js/39.3f618929.js"><link rel="prefetch" href="/blog/assets/js/4.27174d7e.js"><link rel="prefetch" href="/blog/assets/js/40.68d5acb3.js"><link rel="prefetch" href="/blog/assets/js/41.735a32f6.js"><link rel="prefetch" href="/blog/assets/js/42.2dcfb427.js"><link rel="prefetch" href="/blog/assets/js/43.4076a469.js"><link rel="prefetch" href="/blog/assets/js/44.477f0d75.js"><link rel="prefetch" href="/blog/assets/js/45.53f271d0.js"><link rel="prefetch" href="/blog/assets/js/46.b94bea94.js"><link rel="prefetch" href="/blog/assets/js/47.633fed06.js"><link rel="prefetch" href="/blog/assets/js/48.ca846c64.js"><link rel="prefetch" href="/blog/assets/js/49.fc38f4cf.js"><link rel="prefetch" href="/blog/assets/js/5.1be6cc54.js"><link rel="prefetch" href="/blog/assets/js/50.71634729.js"><link rel="prefetch" href="/blog/assets/js/51.e13e6318.js"><link rel="prefetch" href="/blog/assets/js/52.9f9da127.js"><link rel="prefetch" href="/blog/assets/js/53.fd90eaf9.js"><link rel="prefetch" href="/blog/assets/js/54.f5805575.js"><link rel="prefetch" href="/blog/assets/js/55.5f9d6238.js"><link rel="prefetch" href="/blog/assets/js/56.7c668336.js"><link rel="prefetch" href="/blog/assets/js/57.e5f6bdfa.js"><link rel="prefetch" href="/blog/assets/js/58.c395a744.js"><link rel="prefetch" href="/blog/assets/js/59.bc47d200.js"><link rel="prefetch" href="/blog/assets/js/6.873d8e8a.js"><link rel="prefetch" href="/blog/assets/js/60.c95d2560.js"><link rel="prefetch" href="/blog/assets/js/62.0ce22f2f.js"><link rel="prefetch" href="/blog/assets/js/63.f0843647.js"><link rel="prefetch" href="/blog/assets/js/64.f8d17608.js"><link rel="prefetch" href="/blog/assets/js/65.57772a37.js"><link rel="prefetch" href="/blog/assets/js/66.708f9109.js"><link rel="prefetch" href="/blog/assets/js/67.730125ac.js"><link rel="prefetch" href="/blog/assets/js/68.cd821796.js"><link rel="prefetch" href="/blog/assets/js/69.4b22642c.js"><link rel="prefetch" href="/blog/assets/js/7.802f6651.js"><link rel="prefetch" href="/blog/assets/js/70.ab34d6b2.js"><link rel="prefetch" href="/blog/assets/js/71.1025c944.js"><link rel="prefetch" href="/blog/assets/js/72.84aa066c.js"><link rel="prefetch" href="/blog/assets/js/73.11f8e1ad.js"><link rel="prefetch" href="/blog/assets/js/74.6b487d0a.js"><link rel="prefetch" href="/blog/assets/js/75.c895d996.js"><link rel="prefetch" href="/blog/assets/js/76.1ff568a7.js"><link rel="prefetch" href="/blog/assets/js/77.84c6d379.js"><link rel="prefetch" href="/blog/assets/js/78.a6da4b4b.js"><link rel="prefetch" href="/blog/assets/js/79.9d45ca76.js"><link rel="prefetch" href="/blog/assets/js/8.3784e140.js"><link rel="prefetch" href="/blog/assets/js/80.a2e5077a.js"><link rel="prefetch" href="/blog/assets/js/81.0ef059d5.js"><link rel="prefetch" href="/blog/assets/js/82.c338d27e.js"><link rel="prefetch" href="/blog/assets/js/83.db892f3a.js"><link rel="prefetch" href="/blog/assets/js/84.d3d65364.js"><link rel="prefetch" href="/blog/assets/js/85.f2d7994c.js"><link rel="prefetch" href="/blog/assets/js/86.b4f175cc.js"><link rel="prefetch" href="/blog/assets/js/87.efe9bd77.js"><link rel="prefetch" href="/blog/assets/js/88.e6a181a0.js"><link rel="prefetch" href="/blog/assets/js/89.c2b350ed.js"><link rel="prefetch" href="/blog/assets/js/9.d63a5449.js"><link rel="prefetch" href="/blog/assets/js/90.aca6ae33.js"><link rel="prefetch" href="/blog/assets/js/91.851541fc.js"><link rel="prefetch" href="/blog/assets/js/92.ba46d071.js"><link rel="prefetch" href="/blog/assets/js/93.dfb608ce.js"><link rel="prefetch" href="/blog/assets/js/94.99c44a9d.js"><link rel="prefetch" href="/blog/assets/js/95.ff8d595e.js"><link rel="prefetch" href="/blog/assets/js/96.6bfcd613.js"><link rel="prefetch" href="/blog/assets/js/97.0f10eff2.js"><link rel="prefetch" href="/blog/assets/js/98.35acd6a9.js"><link rel="prefetch" href="/blog/assets/js/99.a2602645.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.852bfa04.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/web_logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><a href="/blog/blog/" class="link-title router-link-active">Blog</a> <span class="title" style="display:none;">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/lang/" class="nav-link">Language</a></li></ul></li><li class="dropdown-item"><h4>设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/design/" class="nav-link">Design</a></li></ul></li><li class="dropdown-item"><h4>网络</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/network/" class="nav-link router-link-active">Network</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/database/" class="nav-link">Database</a></li></ul></li><li class="dropdown-item"><h4>平台</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/platform/" class="nav-link">Platform</a></li></ul></li><li class="dropdown-item"><h4>技能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/skills/##Devops" class="nav-link">Devops</a></li><li class="dropdown-subitem"><a href="/blog/blog/skills/##Ai" class="nav-link">AI</a></li></ul></li><li class="dropdown-item"><h4>应用</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utilization/" class="nav-link">Utilization</a></li></ul></li><li class="dropdown-item"><h4>杂项</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utility/##Rnote" class="nav-link">ReadNote</a></li><li class="dropdown-subitem"><a href="/blog/blog/utility/##Tools" class="nav-link">Tools</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/more/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/blog/more/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><h4>收藏</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/more/favorites/" class="nav-link">favorites</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/index/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/index/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/index/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/index/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/joyous-x/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>Jiao</h3> <span>知行合一</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><a href="/blog/blog/" class="link-title router-link-active">Blog</a> <span class="title" style="display:none;">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/lang/" class="nav-link">Language</a></li></ul></li><li class="dropdown-item"><h4>设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/design/" class="nav-link">Design</a></li></ul></li><li class="dropdown-item"><h4>网络</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/network/" class="nav-link router-link-active">Network</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/database/" class="nav-link">Database</a></li></ul></li><li class="dropdown-item"><h4>平台</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/platform/" class="nav-link">Platform</a></li></ul></li><li class="dropdown-item"><h4>技能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/skills/##Devops" class="nav-link">Devops</a></li><li class="dropdown-subitem"><a href="/blog/blog/skills/##Ai" class="nav-link">AI</a></li></ul></li><li class="dropdown-item"><h4>应用</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utilization/" class="nav-link">Utilization</a></li></ul></li><li class="dropdown-item"><h4>杂项</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utility/##Rnote" class="nav-link">ReadNote</a></li><li class="dropdown-subitem"><a href="/blog/blog/utility/##Tools" class="nav-link">Tools</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/more/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/blog/more/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><h4>收藏</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/more/favorites/" class="nav-link">favorites</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/index/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/index/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/index/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/index/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/joyous-x/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/blog/categories/?category=blog" title="分类" data-v-0c557b5e>blog</a></li><li data-v-0c557b5e><a href="/blog/categories/?category=network" title="分类" data-v-0c557b5e>network</a></li><li data-v-0c557b5e><a href="/blog/categories/?category=grpc" title="分类" data-v-0c557b5e>grpc</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://github.com/joyous-x" target="_blank" title="作者" class="beLink" data-v-0c557b5e>Jiao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2020-04-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">gRPC over HTTP2<!----></h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="grpc-over-http2"><a href="#grpc-over-http2" class="header-anchor">#</a> gRPC over HTTP2</h1> <blockquote><p>原文：https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md</p></blockquote> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p>本文主要描述 grpc 基于 <a href="https://tools.ietf.org/html/rfc7540" target="_blank" rel="noopener noreferrer">http2 framing<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的实现</p> <h2 id="大纲"><a href="#大纲" class="header-anchor">#</a> 大纲</h2> <p>下述是在一次grpc请求和应答里通用的消息原子组成:</p> <ul><li>Request → Request-Headers *Length-Prefixed-Message EOS</li> <li>Response → (Response-Headers *Length-Prefixed-Message Trailers) / Trailers-Only</li></ul> <h2 id="requests"><a href="#requests" class="header-anchor">#</a> Requests</h2> <ul><li>Request → Request-Headers *Length-Prefixed-Message EOS</li></ul> <h3 id="request-headers"><a href="#request-headers" class="header-anchor">#</a> Request-Headers</h3> <p>Request-Headers 被当作用 http2 headers，通过 HEADERS + CONTINUATION 帧来传输</p> <ul><li>Request-Headers → Call-Definition *Custom-Metadata
<ul><li>Call-Definition → Method Scheme Path TE [Authority] [Timeout] Content-Type [Message-Type] [Message-Encoding] [Message-Accept-Encoding] [User-Agent]
<ul><li>Method → &quot;:method POST&quot;</li> <li>Scheme → &quot;:scheme &quot; (&quot;http&quot; / &quot;https&quot;)</li> <li>Path → &quot;:path&quot; &quot;/&quot; Service-Name &quot;/&quot; {method name} # But see note below.
<ul><li>Service-Name → {IDL-specific service name}</li></ul></li> <li>Authority → &quot;:authority&quot; {virtual host name of authority}</li> <li>TE → &quot;te&quot; &quot;trailers&quot; # Used to detect incompatible proxies</li> <li>Timeout → &quot;grpc-timeout&quot; TimeoutValue TimeoutUnit</li> <li>TimeoutValue → {positive integer as ASCII string of at most 8 digits}</li> <li>TimeoutUnit → Hour / Minute / Second / Millisecond / Microsecond / Nanosecond
<ul><li>Hour → &quot;H&quot;</li> <li>Minute → &quot;M&quot;</li> <li>Second → &quot;S&quot;</li> <li>Millisecond → &quot;m&quot;</li> <li>Microsecond → &quot;u&quot;</li> <li>Nanosecond → &quot;n&quot;</li></ul></li> <li>Content-Type → &quot;content-type&quot; &quot;application/grpc&quot; [(&quot;+proto&quot; / &quot;+json&quot; / {custom})]</li> <li>Content-Coding → &quot;identity&quot; / &quot;gzip&quot; / &quot;deflate&quot; / &quot;snappy&quot; / {custom}</li> <li>Message-Encoding → &quot;grpc-encoding&quot; Content-Coding</li> <li>Message-Accept-Encoding → &quot;grpc-accept-encoding&quot; Content-Coding *(&quot;,&quot; Content-Coding)</li> <li>User-Agent → &quot;user-agent&quot; {structured user-agent string}</li> <li>Message-Type → &quot;grpc-message-type&quot; {type name for message schema}</li></ul></li> <li>Custom-Metadata → Binary-Header / ASCII-Header
<ul><li>Binary-Header → {Header-Name &quot;-bin&quot; } {base64 encoded value}</li> <li>ASCII-Header → Header-Name ASCII-Value</li> <li>Header-Name → 1*( %x30-39 / %x61-7A / &quot;_&quot; / &quot;-&quot; / &quot;.&quot;) ; 0-9 a-z _ - .</li> <li>ASCII-Value → 1*( %x20-%x7E ) ; space and printable ASCII</li></ul></li></ul></li></ul> <p>HTTP2 协议要求 reserved headers (以 &quot;:&quot; 开头的 header) 必须出现在其他 headers 之前。此外，还要求 Timeout 头必须紧跟在 reserved headers 之后被发送。还有就是，Call-Definition 需要在发送 Custom-Metadata 之前发送。</p> <p>一些 gRPC 的实现可能会允许上面的 Path 格式被覆盖，但是这样的功能是强烈不推荐的。gRPC 不会特意的去阻止用户使用 Path 格式覆盖这个功能, 但我们绝不会主动的支持它，另外就是当 PATH 的格式不是上述那样的话, 一些功能(如：service config support)可能会不能正常工作。</p> <p>在 Timeout 被缺省时, 服务端应当假定 Timeout 是无穷大的。客户端实现可以根据其部署要求自由发送默认的最小超时时间。</p> <p>如果 Content-Type 不是以 &quot;application/grpc&quot; 开头时, gRPC 服务端应当以 HTTP 状态码 415 (Unsupported Media Type) 进行应答。这样, 能阻断 HTTP/2 的客户端(以状态码200标识成功)解析一个 gRPC 错误。</p> <p>Custom-Metadata 是一系列由应用层定义的 key-value 键值对组成的集合。应用程序不能使用以 &quot;grpc-&quot; 开头的 Header 名作为 Custom-Metadata 的 key, 因为以 &quot;grpc-&quot; 开头的 Header 名被用于预留的在未来给 GRPC 使用。</p> <p>注意，因为 HTTP2 不允许二进制序列作为 header 的值，所以二进制的 header 值必须使用 Base64 编码。实现时必须可以接收 padded 和 un-padded 的值，发送 un-padded 的值。应用程序定义的二进制 header 名需要以 &quot;-bin&quot; 为后缀。运行库可以使用这个后缀检测出二进制的 headers，然后在发送和接收时使用 base64 进行加解密。</p> <p>Custom-Metadata 不能保证 header 的顺序除非有重复的 header 名。当有重复的 header 名时，在语义上等价于将他们的值以 &quot;,&quot; 作为分隔符拼接起来。所以，实现时需要注意，对于 二进制类型的 header，需要先用 &quot;,&quot; 进行分割，然后再用 base64 进行解密处理。</p> <p>Custom-Metadata 的 ASCII 类型的值，不能有空格做前后缀，如果有的话，会被剥离掉。另外，这里可以使用的 ASCII 字符范围比 HTTP 更加严格。实现时，不能因为接收到在 HTTP 有效但在 Custom-Metadata 中无效的 ASCII 字符而出错，但是却没有严格定义具体的行为：可以抛弃也可以接受这个值。如果被接受，必须注意确保允许应用程序将值作为元数据回显。例如，如果这个元数据被当作一个列表在一个请求中传递给应用程序，那么如果应用程序把这个元数据放在应答中时不应引发一个错误。</p> <p>服务端可以限制 Request-Headers 的大小，建议默认 8kb。建议实现时计算 header 的总大小，像 HTTP/2 的 SETTINGS_MAX_HEADER_LIST_SIZE 那样：the sum of all header fields, for each field the sum of the uncompressed field name and value lengths plus 32, with binary values' lengths being post-Base64.</p> <h3 id="length-prefixed-message"><a href="#length-prefixed-message" class="header-anchor">#</a> Length-Prefixed-Message</h3> <p>一个 Request 中可以有多个 Length-Prefixed-Message 数据，它们通过 http2 的 DATA 帧进行传输。</p> <ul><li>Length-Prefixed-Message → Compressed-Flag Message-Length Message
<ul><li>Compressed-Flag → 0 / 1 # encoded as 1 byte unsigned integer</li> <li>Message-Length → {length of Message} # encoded as 4 byte unsigned integer (big endian)</li> <li>Message → *{binary octet}</li></ul></li></ul> <p>当 Compressed-Flag 值为1时，标识着二进制的 Message 是使用 Message-Encoding 头中声明的方式压缩过的。值为0时,意味着没有被压缩。
如果  Message-Encoding 头缺省的情况下，Compressed-Flag 值必须为0。压缩的上下文信息不会在跨越 message 边界时依然被维护，所以，实现时必须为流中的每一个 message 创建一个新的上下文。</p> <h3 id="eos-end-of-stream"><a href="#eos-end-of-stream" class="header-anchor">#</a> EOS(end-of-stream)</h3> <p>对于请求来说，EOS (end-of-stream) 通过接收到的最后一个 DATA 帧中的 END_STREAM 标记来标识的。在 Request 需要被关闭但是又没有数据需要发送的情况下，gRPC的实现必须发送一个包含 END_STREAM 标记的空 DATA 帧。</p> <h2 id="responses"><a href="#responses" class="header-anchor">#</a> Responses</h2> <ul><li>Response → (Response-Headers *Length-Prefixed-Message Trailers) / Trailers-Only</li></ul> <h3 id="response-headers"><a href="#response-headers" class="header-anchor">#</a> Response-Headers</h3> <ul><li>Response-Headers → HTTP-Status [Message-Encoding] [Message-Accept-Encoding] Content-Type *Custom-Metadata</li> <li>Trailers-Only → HTTP-Status Content-Type Trailers</li> <li>Trailers → Status [Status-Message] *Custom-Metadata
<ul><li>Status → &quot;grpc-status&quot; 1*DIGIT ; 0-9</li> <li>Status-Message → &quot;grpc-message&quot; Percent-Encoded
<ul><li>Percent-Encoded → 1*(Percent-Byte-Unencoded / Percent-Byte-Encoded)
<ul><li>Percent-Byte-Unencoded → 1*( %x20-%x24 / %x26-%x7E ) ; space and VCHAR, except %</li> <li>Percent-Byte-Encoded → &quot;%&quot; 2HEXDIGIT ; 0-9 A-F</li></ul></li></ul></li> <li>HTTP-Status → &quot;:status 200&quot;</li></ul></li></ul> <p>Response-Headers 和 Trailers-Only 都是通过一个独立的 HTTP2 HEADERS 帧块进行传输。大多数的 responses 都应该既有 headers 又有 trailers，但是 Trailers-Only 当在需要产生一个即时错误时是被允许的。另外，Status 信息必须在 Trailers 中，即使 status code 是 OK.</p> <p>对于 responses 来说，end-of-stream 是通过最后一个传输 Trailers 的 HEADERS 帧的 END_STREAM 标记来标示的。</p> <p>实现时应当期望 broken deployments 在响应中发送 非200 的 HTTP状态代码以及各种非GRPC内容类型并且省略状态和状态消息。当这种情况发生时，实现时必须合成一个 Status &amp; Status-Message 以传播给应用层</p> <p>客户端应当限制 Response-Headers, Trailers, 或 Trailers-Only 的大小，一般推荐上述对象的大小限制都是 8Kb</p> <p>Status 的值部分是十进制编码的整数，作为ASCII字符串，没有任何前导零</p> <p>Status-Message 的值部分理论上应当是一个描述错误的 Unicode 字符串，实际上多用 UTF-8 跟着是 url 编码(percent-encoding)。当解码无效值时，该实现一定不能抛出错误 或者 丢弃这个 message。最坏情况，就是终止解码这个 Status-Message，这样用户可以接收到原始的 url 编码格式数据。或者，该实现可以解码有效部分，同时保留损坏的％ - 编码，或者用替换字符(例如，'？'或Unicode替换字符)替换它们。</p> <h2 id="example"><a href="#example" class="header-anchor">#</a> Example</h2> <p>以下以 unary-call 为例展示 HTTP2 的帧序列</p> <h3 id="request"><a href="#request" class="header-anchor">#</a> Request</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>    HEADERS (flags = END_HEADERS)
    :method = POST
    :scheme = http
    :path = /google.pubsub.v2.PublisherService/CreateTopic
    :authority = pubsub.googleapis.com
    grpc-timeout = 1S
    content-type = application/grpc+proto
    grpc-encoding = gzip
    authorization = Bearer y235.wef315yfh138vh31hv93hv8h3v

    DATA (flags = END_STREAM)
    &lt;Length-Prefixed Message&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="response"><a href="#response" class="header-anchor">#</a> Response</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>    HEADERS (flags = END_HEADERS)
    :status = 200
    grpc-encoding = gzip
    content-type = application/grpc+proto

    DATA
    &lt;Length-Prefixed Message&gt;

    HEADERS (flags = END_STREAM, END_HEADERS)
    grpc-status = 0 # OK
    trace-proto-bin = jher831yy13JHy3hc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="user-agents"><a href="#user-agents" class="header-anchor">#</a> User Agents</h2> <p>虽然协议不要求用户代理来运行，但建议客户端提供结构化的用户代理字符串，该字符串提供了调用库、版本和平台的基本描述，以便在异构环境中进行问题诊断。建议库开发人员使用以下结构:
<code>User-Agent → &quot;grpc-&quot; Language ?(&quot;-&quot; Variant) &quot;/&quot; Version ?( &quot; (&quot; *(AdditionalProperty &quot;;&quot;) &quot;)&quot; )</code>
E.g.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    grpc-java/1.2.3
    grpc-ruby/1.2.3
    grpc-ruby-jruby/1.3.4
    grpc-java-android/0.9.1 (gingerbread/1.2.4; nexus5; tmobile)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="幂等性-和-重试"><a href="#幂等性-和-重试" class="header-anchor">#</a> 幂等性 和 重试</h2> <p>除非被显示的定位, 不然 gRPC 调用不应被假设为幂等的. 特别地:</p> <ul><li>无法验证已启动的调用将不会重试</li> <li>没有重复抑制机制，因为没有必要</li> <li>标记为幂等的呼叫可以多次发送</li></ul> <h2 id="http2-transport-mapping"><a href="#http2-transport-mapping" class="header-anchor">#</a> HTTP2 Transport Mapping</h2> <h3 id="stream-identification"><a href="#stream-identification" class="header-anchor">#</a> Stream Identification</h3> <p>所有 GRPC 调用都需要指定一个内部ID。我们将在此方案中使用 HTTP2 stream-id 作为调用标识符。注意：这些 ID 是已打开 HTTP2 会话的上下文，并且，在处理多个 HTTP2 会话的给定进程中不是唯一的，也不能用作GUID。</p> <h3 id="data-frames"><a href="#data-frames" class="header-anchor">#</a> Data Frames</h3> <p>DATA 帧边界与 Length-Prefixed-Message 边界无关，并且实现不应对其对齐做出任何假设。</p> <h3 id="errors"><a href="#errors" class="header-anchor">#</a> Errors</h3> <p>在 RPC 期间发生应用程序或运行时错误时，将在 Trailers 中传递 Status 和 Status-Message。</p> <p>在某些情况下，消息流的帧可能已损坏，RPC 运行时将选择使用 RST_STREAM 帧向其对等方指示此状态。RPC运行时实现应该将 RST_STREAM 解释为流的立即 full-closure，并且应该将错误传播到调用应用程序层。</p> <h3 id="security"><a href="#security" class="header-anchor">#</a> Security</h3> <p>当 TLS 与 HTTP2 一起使用时，HTTP2 规范要求使用 TLS 1.2 或更高版本。它还对部署中允许的密码施加了一些额外的限制，以避免已知问题以及需要SNI支持。另外，预计 HTTP2 将与专有传输安全机制结合使用，此时规范不能对其提出任何有意义的建议</p> <h2 id="connection-management"><a href="#connection-management" class="header-anchor">#</a> Connection Management</h2> <h3 id="goaway-frame"><a href="#goaway-frame" class="header-anchor">#</a> GOAWAY Frame</h3> <p>由 servers 发送给 clients 用于标识 servers 不再在相关的连接上接收任何新的 stream。这个帧包含了 server 成功接收的最后一个 stream id。clients 应该认为最后一个被 server 成功接收的 stream 之后的任何 stream 都是 UNAVAILABLE，应当在其他地方进行重试。clients 可以继续处理已接受的流，直到它们完成或连接终止。</p> <p>servers 应当在终止连接前发送 GOAWAY 帧，以可靠地通知 clients 哪些工作已被服务器接受并正在执行。</p> <h3 id="ping-frame"><a href="#ping-frame" class="header-anchor">#</a> PING Frame</h3> <p>clients 和 servers 都可以发送 PING 帧，对端必须以它接收到的内容进行回复。它被用来断定连接依然存活，并提供了一种评估 end-to-end 延迟的方法。如果 servers 启动的 PING 未在运行时期望的截止期限内收到响应，则服务器上的所有未完成调用将以 CANCELED 状态关闭。如果 clients 启动的 PING 超时未收到响应时，将导致所有调用以 UNAVAILABLE 状态关闭。请注意，PING 的频率高度依赖于网络环境，实现可以根据网络和应用要求自由调整 PING 频率。</p> <h3 id="connection-failure"><a href="#connection-failure" class="header-anchor">#</a> Connection failure</h3> <p>如果客户端上发生可检测的连接故障，则将以 UNAVAILABLE 状态关闭所有调用。对于服务器，将以 CANCELED 状态关闭打开的调用。</p> <h2 id="appendix-a-grpc-for-protobuf"><a href="#appendix-a-grpc-for-protobuf" class="header-anchor">#</a> Appendix A - GRPC for Protobuf</h2> <ol><li>protobuf 声明的服务接口很容易通过 protoc 的代码生成扩展映射到 GRPC 上。以下定义要使用的映射。
<ul><li>Service-Name → ?( {proto package name} &quot;.&quot; ) {service name}</li> <li>Message-Type → {fully qualified proto message name}</li> <li>Content-Type → &quot;application/grpc+proto&quot;</li></ul></li></ol></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/blog/lang/cxx_static_analyze.html"><div>
            Cxx Static Analyze
            <!----></div></a> <span class="date">04-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/blog/lang/cxx_features.html"><div>
            CXX features
            <!----></div></a> <span class="date">04-02</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/blog/xnote/about_heart_and_mind.html"><div>
            关于心学
            <!----></div></a> <span class="date">03-28</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:929843628@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/joyous-x" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2022
    <span>Jiao | <a href="https://github.com/joyous-x/blog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/blog/assets/js/app.a3f4fb79.js" defer></script><script src="/blog/assets/js/3.43c8fac8.js" defer></script><script src="/blog/assets/js/61.2162cd41.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Office 格式简析</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/img/favicon.ico">
    <meta name="description" content="Office 格式简析，查找 宏 以进行病毒检测">
    <meta name="keywords" content="博客,全栈,技术文档,学习,面试,Go,C/C++,Python,Markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/blog/assets/css/0.styles.af7e6128.css" as="style"><link rel="preload" href="/blog/assets/js/app.d6ef53bd.js" as="script"><link rel="preload" href="/blog/assets/js/2.105f29df.js" as="script"><link rel="preload" href="/blog/assets/js/3.858ab1d1.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.3bd69934.js"><link rel="prefetch" href="/blog/assets/js/11.c06753fe.js"><link rel="prefetch" href="/blog/assets/js/12.b00eeebd.js"><link rel="prefetch" href="/blog/assets/js/13.f4e147af.js"><link rel="prefetch" href="/blog/assets/js/14.7e9b98ee.js"><link rel="prefetch" href="/blog/assets/js/15.4d09c8e0.js"><link rel="prefetch" href="/blog/assets/js/16.8fd5ea3e.js"><link rel="prefetch" href="/blog/assets/js/17.06c5d654.js"><link rel="prefetch" href="/blog/assets/js/18.b1c7993e.js"><link rel="prefetch" href="/blog/assets/js/19.ae9426a0.js"><link rel="prefetch" href="/blog/assets/js/20.fad2c003.js"><link rel="prefetch" href="/blog/assets/js/21.805f0e07.js"><link rel="prefetch" href="/blog/assets/js/22.9d6326b9.js"><link rel="prefetch" href="/blog/assets/js/23.e9ba4232.js"><link rel="prefetch" href="/blog/assets/js/24.b0f04bb4.js"><link rel="prefetch" href="/blog/assets/js/25.ec9383d4.js"><link rel="prefetch" href="/blog/assets/js/26.cd7694ea.js"><link rel="prefetch" href="/blog/assets/js/27.b9ae3a75.js"><link rel="prefetch" href="/blog/assets/js/28.5203f264.js"><link rel="prefetch" href="/blog/assets/js/29.d5e943a2.js"><link rel="prefetch" href="/blog/assets/js/30.1a304490.js"><link rel="prefetch" href="/blog/assets/js/31.0bdb2247.js"><link rel="prefetch" href="/blog/assets/js/32.8351695b.js"><link rel="prefetch" href="/blog/assets/js/33.8db16803.js"><link rel="prefetch" href="/blog/assets/js/34.decc5746.js"><link rel="prefetch" href="/blog/assets/js/35.7b0e14b1.js"><link rel="prefetch" href="/blog/assets/js/36.1a9c8e5f.js"><link rel="prefetch" href="/blog/assets/js/37.ea8a1f64.js"><link rel="prefetch" href="/blog/assets/js/38.11c155a7.js"><link rel="prefetch" href="/blog/assets/js/39.4dedcd9d.js"><link rel="prefetch" href="/blog/assets/js/4.b6b8c4ea.js"><link rel="prefetch" href="/blog/assets/js/40.f3d95691.js"><link rel="prefetch" href="/blog/assets/js/41.14819217.js"><link rel="prefetch" href="/blog/assets/js/42.d799b5de.js"><link rel="prefetch" href="/blog/assets/js/43.76ded75f.js"><link rel="prefetch" href="/blog/assets/js/44.da78360c.js"><link rel="prefetch" href="/blog/assets/js/45.0f3f527f.js"><link rel="prefetch" href="/blog/assets/js/46.d4bbd44f.js"><link rel="prefetch" href="/blog/assets/js/47.195cff90.js"><link rel="prefetch" href="/blog/assets/js/48.ccc94fa3.js"><link rel="prefetch" href="/blog/assets/js/49.67cc94b4.js"><link rel="prefetch" href="/blog/assets/js/5.6e140a3a.js"><link rel="prefetch" href="/blog/assets/js/50.728859e4.js"><link rel="prefetch" href="/blog/assets/js/51.f8776ca1.js"><link rel="prefetch" href="/blog/assets/js/52.dc0e2357.js"><link rel="prefetch" href="/blog/assets/js/53.4d978f9e.js"><link rel="prefetch" href="/blog/assets/js/54.9a1e0c15.js"><link rel="prefetch" href="/blog/assets/js/55.81712a8b.js"><link rel="prefetch" href="/blog/assets/js/56.be170788.js"><link rel="prefetch" href="/blog/assets/js/57.fa477f26.js"><link rel="prefetch" href="/blog/assets/js/58.0dca8f3e.js"><link rel="prefetch" href="/blog/assets/js/59.9c8e4b4a.js"><link rel="prefetch" href="/blog/assets/js/6.b1ae2862.js"><link rel="prefetch" href="/blog/assets/js/60.e744fd08.js"><link rel="prefetch" href="/blog/assets/js/61.478d7853.js"><link rel="prefetch" href="/blog/assets/js/62.5aa07af2.js"><link rel="prefetch" href="/blog/assets/js/63.8b41de83.js"><link rel="prefetch" href="/blog/assets/js/64.ae655298.js"><link rel="prefetch" href="/blog/assets/js/65.cfa45e04.js"><link rel="prefetch" href="/blog/assets/js/66.8c33c97f.js"><link rel="prefetch" href="/blog/assets/js/67.2e48e8f8.js"><link rel="prefetch" href="/blog/assets/js/68.3385a9d6.js"><link rel="prefetch" href="/blog/assets/js/69.a0412acf.js"><link rel="prefetch" href="/blog/assets/js/7.ea2e198a.js"><link rel="prefetch" href="/blog/assets/js/70.6c8f81c7.js"><link rel="prefetch" href="/blog/assets/js/71.8e7ef977.js"><link rel="prefetch" href="/blog/assets/js/72.7475bee9.js"><link rel="prefetch" href="/blog/assets/js/73.87af6eab.js"><link rel="prefetch" href="/blog/assets/js/74.634a0f2b.js"><link rel="prefetch" href="/blog/assets/js/75.3197ad0d.js"><link rel="prefetch" href="/blog/assets/js/76.a22fafd4.js"><link rel="prefetch" href="/blog/assets/js/77.4fc28795.js"><link rel="prefetch" href="/blog/assets/js/78.bedbe768.js"><link rel="prefetch" href="/blog/assets/js/79.5cde3c01.js"><link rel="prefetch" href="/blog/assets/js/8.91b522b1.js"><link rel="prefetch" href="/blog/assets/js/80.cf3fea22.js"><link rel="prefetch" href="/blog/assets/js/81.52b4a99b.js"><link rel="prefetch" href="/blog/assets/js/82.5e44e6f6.js"><link rel="prefetch" href="/blog/assets/js/83.129e0bd3.js"><link rel="prefetch" href="/blog/assets/js/84.67c493d6.js"><link rel="prefetch" href="/blog/assets/js/85.41812274.js"><link rel="prefetch" href="/blog/assets/js/86.2bd4d5bd.js"><link rel="prefetch" href="/blog/assets/js/87.fb5a3f0b.js"><link rel="prefetch" href="/blog/assets/js/88.ced8c7b8.js"><link rel="prefetch" href="/blog/assets/js/89.f21e0cc2.js"><link rel="prefetch" href="/blog/assets/js/9.afcc4ac8.js"><link rel="prefetch" href="/blog/assets/js/90.5d3876b9.js"><link rel="prefetch" href="/blog/assets/js/91.f963e938.js"><link rel="prefetch" href="/blog/assets/js/92.124339ef.js"><link rel="prefetch" href="/blog/assets/js/93.29bfb928.js"><link rel="prefetch" href="/blog/assets/js/94.f81f261f.js"><link rel="prefetch" href="/blog/assets/js/95.b2e04d27.js"><link rel="prefetch" href="/blog/assets/js/96.fcc6f13e.js"><link rel="prefetch" href="/blog/assets/js/97.f7d9cbd6.js"><link rel="prefetch" href="/blog/assets/js/98.2e774558.js"><link rel="prefetch" href="/blog/assets/js/99.af69701a.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.af7e6128.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/web_logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><a href="/blog/blog/" class="link-title router-link-active">Blog</a> <span class="title" style="display:none;">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/lang/" class="nav-link">Language</a></li></ul></li><li class="dropdown-item"><h4>设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/design/" class="nav-link">Design</a></li></ul></li><li class="dropdown-item"><h4>网络</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/network/" class="nav-link">Network</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/database/" class="nav-link">Database</a></li></ul></li><li class="dropdown-item"><h4>平台</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/platform/" class="nav-link">Platform</a></li></ul></li><li class="dropdown-item"><h4>技能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/skills/##Devops" class="nav-link">Devops</a></li><li class="dropdown-subitem"><a href="/blog/blog/skills/##Ai" class="nav-link">AI</a></li></ul></li><li class="dropdown-item"><h4>应用</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utilization/" class="nav-link">Utilization</a></li></ul></li><li class="dropdown-item"><h4>杂项</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utility/##Rnote" class="nav-link">ReadNote</a></li><li class="dropdown-subitem"><a href="/blog/blog/utility/##Tools" class="nav-link">Tools</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/more/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/blog/more/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><h4>收藏</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/more/favorites/" class="nav-link">favorites</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/index/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/index/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/index/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/index/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/joyous-x/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>Jiao</h3> <span>知行合一</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><a href="/blog/blog/" class="link-title router-link-active">Blog</a> <span class="title" style="display:none;">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/lang/" class="nav-link">Language</a></li></ul></li><li class="dropdown-item"><h4>设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/design/" class="nav-link">Design</a></li></ul></li><li class="dropdown-item"><h4>网络</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/network/" class="nav-link">Network</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/database/" class="nav-link">Database</a></li></ul></li><li class="dropdown-item"><h4>平台</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/platform/" class="nav-link">Platform</a></li></ul></li><li class="dropdown-item"><h4>技能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/skills/##Devops" class="nav-link">Devops</a></li><li class="dropdown-subitem"><a href="/blog/blog/skills/##Ai" class="nav-link">AI</a></li></ul></li><li class="dropdown-item"><h4>应用</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utilization/" class="nav-link">Utilization</a></li></ul></li><li class="dropdown-item"><h4>杂项</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/blog/utility/##Rnote" class="nav-link">ReadNote</a></li><li class="dropdown-subitem"><a href="/blog/blog/utility/##Tools" class="nav-link">Tools</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/more/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/blog/more/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><h4>收藏</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/more/favorites/" class="nav-link">favorites</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/index/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/index/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/index/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/index/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/joyous-x/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/blog/categories/?category=blog" title="分类" data-v-0c557b5e>blog</a></li><li data-v-0c557b5e><a href="/blog/categories/?category=skills" title="分类" data-v-0c557b5e>skills</a></li><li data-v-0c557b5e><a href="/blog/categories/?category=office" title="分类" data-v-0c557b5e>office</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://github.com/joyous-x" target="_blank" title="作者" class="beLink" data-v-0c557b5e>Jiao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2021-06-18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Office 格式简析<!----></h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="office-格式简析"><a href="#office-格式简析" class="header-anchor">#</a> Office 格式简析</h1> <p>目前常见的 Microsoft Office 格式主要分为 97 ~ 2003 和 2007 ~ 两种格式。<code>Microsoft Office 97 ~ 2003</code> 的文件格式都是由 MS-CFB 结构来表示的 OLE 文件。<code>Microsoft Office 2007 ~</code>则是由 OOXML 格式的文件结构压缩而成的 zip 包来存储。</p> <p>而 OOXML 又是以 XML 文件为基础的，所以，概括的说，Office文档主要基于 ole、xml、ooxml 这三种文件格式构建起来的。</p> <p>常见的文件扩展名以及用途如下：</p> <table><thead><tr><th style="text-align:left;">Extensions</th> <th>Usage</th> <th>Remark</th></tr></thead> <tbody><tr><td style="text-align:left;">doc、xls、ppt</td> <td>属于 97-2003 版 Office</td> <td></td></tr> <tr><td style="text-align:left;">docx、xlsx、pptx</td> <td>属于 2007 ~ 版 Office 文档，但没有启用宏</td> <td></td></tr> <tr><td style="text-align:left;">docm、xlsm、pptm</td> <td>属于启用了宏的 2007 ~ 版 Office 文档，可以存储 Visual Basic Applications（VBA）宏代码</td> <td></td></tr> <tr><td style="text-align:left;">ppsx</td> <td>是 2007 的 PPT 的一种格式，打开就是幻灯片播放模式</td> <td></td></tr></tbody></table> <p>按照我们常规的认知，一个文档应当包含以下几个部分：</p> <ol><li>文档内容
<ul><li>可能涉及对 embedded objects 或 external objects 的引用</li> <li>文档的展示相关：字体、页面大小、打印方式等等</li></ul></li> <li>文档工具
<ul><li>为了更好、更方便的操作文档内容进行编辑、展示、提示以及其他功能，而提供的一些跟文档相关的组件，如 vba、formula、animation 等等</li></ul></li> <li>文档属性
<ul><li>如，创作时间、作者、最后修改时间等等</li></ul></li> <li>保护措施
<ul><li>签名</li> <li>读(打开)、写 保护</li></ul></li></ol> <h2 id="一、malware"><a href="#一、malware" class="header-anchor">#</a> 一、Malware</h2> <p>由于 ms-office 文件的广泛使用，恶意软件作者对其进行了充分的挖掘、利用，催生出了一系列针对这些文档的病毒，期中常常被用于恶意目的的组件或者方式有：宏病毒、漏洞利用、嵌入文件</p> <h3 id="_1-1-漏洞"><a href="#_1-1-漏洞" class="header-anchor">#</a> 1.1 漏洞</h3> <p>漏洞利用是指软件自身缺陷被攻击者利用来执行高危动作，如利用 ole 的特点调用第三方组件并执行；栈溢出造成的任意代码执行漏洞(CVE-2017-11882) 等等，常见的漏洞有：</p> <ul><li><a href="">CVE-2017-11882</a></li> <li><a href="https://www.secpulse.com/archives/67027.html" target="_blank" rel="noopener noreferrer">CVE-2018-0802<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2019-0801" target="_blank" rel="noopener noreferrer">CVE-2019-0801<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://bbs.pediy.com/thread-269266.htm" target="_blank" rel="noopener noreferrer">CVE-2021-40444<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="_1-2-宏病毒"><a href="#_1-2-宏病毒" class="header-anchor">#</a> 1.2 宏病毒</h3> <p>宏（Macro）是 ms-office 提供的一种利用一系列独立的 office 命令来实现任务执行的自动化，以简化日常工作的工具。当前的 ms-office 是使用 Visual Basic for Applications（VBA）编写的，它是 Microsoft 的 Visual Basic 编程语言专门为 Office 服务的一种变体。VBA 可在大多数 Office 程序中使用，例如 Access，Excel，Outlook，PowerPoint，Project，Publisher，Visio 和 Word 等等。</p> <p>宏病毒主要是利用 宏 来进行感染和传播。它利用宏语言的功能寄存在文档或模板中，一旦带有宏病毒的文档被打开，宏就可能会执行，而宏病毒就会被激活。</p> <p>它的主要感染路径大致如下：<code>单个Office文档 =&gt; Office文档模板 =&gt; 多个Office文档</code>。</p> <p>常见的宏主要存在于以下两种形式(vba &amp;&amp; xlm)：
<center class="half"><img src="/blog/assets/img/sample_vba_a.0fe98adb.png" width="300"> <img src="/blog/assets/img/sample_vba_b.d7aaebc3.png" width="460"></center></p> <p>此外，还有一种攻击方式被称为「模板注入」，实际上还是上述两种 macros 的利用，不过内容可能会随时发生变化</p> <ul><li><img src="/blog/assets/img/office2007_template_inject.d12403d6.png" alt="office2007_template_inject"></li></ul> <p>此外，宏病毒常常用以下方式保护、隐藏自己：</p> <ol><li>禁止提示信息</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>On Error Resume Next                     '如果发生错误，不弹出出错窗口，继续执行下面语句
Application.DisplayAlerts = wdAlertsNone '不弹出警告窗口
Application.DisplayStatusBar = False     '不显示状态栏，以免显示宏的运行状态
Options.VirusProtection = False          '关闭病毒保护功能，运行前如果包含宏，不提示
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>屏蔽命令菜单，不许查看宏</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>' Disable或者删除特定菜单项，用来使“工具—宏”菜单失效的语句：
CommandBars(“Tools”).Controls(16).Enabled = False
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="3"><li>隐藏宏的真实代码</li></ol> <ul><li>在“自动宏”中，不包括任何感染或破坏的代码，但包含了创建、执行和删除新宏（实际进行感染和破坏的宏）的代码；将宏代码字体颜色设置成与背景一样的白色等</li> <li>“自动宏” 是指利用 AutoExec、AutoNew、AutoOpen、AutoClose、AutoExit 自动触发执行的宏</li></ul> <ol start="4"><li>文档密码保护</li></ol> <ul><li>打开文档时需要密码 或者 查看vba脚本时需要密码</li></ul> <p>另外，病毒作者常用<strong>密码逃逸</strong>手段以增加检测难度，事实上也很有效。这种方法的全称是：<code>VelvetSweatshop Default Password Ploy</code>。</p> <ul><li>对象：Excel 4.0 xls 97 ~ files with a compromised macro</li> <li>表现：XLS files appear password protected but aren’t, opening automatically to install malware from compromised macros.</li> <li>原因：Excel 会首先尝试使用默认密码 'VelvetSweatshop' 以 read-only 模式打开文件，如果失败时，再向用户要求输入密码。(This read-only technique has been known about for over 10 years.)</li> <li>Reference
<ul><li>https://threatpost.com/hackers-update-age-old-excel-4-0-macro-attack/154898/</li></ul></li></ul> <h3 id="_1-3-embedded"><a href="#_1-3-embedded" class="header-anchor">#</a> 1.3 Embedded</h3> <p>利用复合文档可以内嵌其它文档的特性，可以嵌套如：</p> <ul><li>images、video、audio</li> <li>other streams, eg. rtf、pdf、docx ... (rtf、docx等复合文档又可以继续嵌套... MY GOD ~)</li></ul> <h2 id="二、ms-cfb"><a href="#二、ms-cfb" class="header-anchor">#</a> 二、MS-CFB</h2> <p>经常被称为 OLE(Object Linking and Embedded)，实际上 OLE (是一种面向对象的技术)包含的内容更多，是 COM 技术的基础，而 CFB 只是 OLE 中关于文件格式的一种描述。</p> <p>复合文档的物理结构比较简单：</p> <ul><li><img src="/blog/assets/img/cfb_sectors.376a1dbc.png" alt="cfb_sectors"></li></ul> <p><em>注意：Compound File Header (512 bytes)也会独占一个 sector, 没有用到的地方填充 0.</em></p> <p>这里是逻辑结构：</p> <ul><li><img src="/blog/assets/img/cfb_summary.74375884.png" alt="cfb_summary"></li></ul> <p>文档中的内容都以 stream 来保持具体内容，storage 来组织 stream 的结构。而这些内容在文件中的位置、查找方式、解读方式，就由 <code>Directory Entry Array</code> 来表达。</p> <p>复合文档的结构非常类似 FAT 文件系统，storage 相当于 directory，stream 相当于 file。为了文件的快速定位，我们需要相应的分区索引表(DiFat 和 Fat)。在 复合文档中，为了节省空间，会将 sector 划分成等长的 <code>short-sector</code> 用于小对象(<code>short-stream</code>)的存储，而它的索引需要 <code>Mini-Fat</code>。</p> <p>由于 CFB 文件由 sectors 组成，这里统一称呼为：</p> <ul><li>msat (master sector allocation table)，又名 DiFat</li> <li>sat (sector allocation table)，又名 Fat</li> <li>ssat (short-sector allocation table)</li> <li>stream</li> <li>short_stream</li></ul> <p>他们的功能如下：</p> <ul><li>msat 表包含了用于构造 sat 表的 sectors 的 sid</li> <li>sat 表包含了很多 sid 链(有特定的 sid 标识链条结束)
<ul><li>每个 sid 链上的 sectors 联合构成了一个完整的 object (如，stream、storage、directory entry array、ssat ...)的物理存储。</li></ul></li> <li>ssat 表包含了很多 ssid 链(有特定的 ssid 标识链条结束)
<ul><li>每个 ssid 链上的 short-sectors 联合构成了一个完整的 short-stream</li></ul></li></ul> <p>到这里，我们大概可以想到为了解析 CFB 结构，需要知道以下几个内容：</p> <ol><li>Directory Entry 的结构 和 存放位置</li> <li>msat 表在文件中的位置</li> <li>stream 和 short-stream 的切割点：什么情况下用 stream 什么时候用 short-stream</li> <li>short-sector 存储于哪些 sector 中</li> <li>ssid 存储于哪些 sector 中</li></ol> <p>这些内容就存放在 Compound File Header 和 Directory Entry Root 中。</p> <h2 id="ole"><a href="#ole" class="header-anchor">#</a> OLE</h2> <p>OLE, Object Linking and Embedded。</p> <p>微软在 1991 年制定的 OLE1.0 规范，主要解决多个应用程序之间的通信和消息传递问题，微软希望第三方开发商能够遵守这个规范，以使在当时的Windows平台上的应用程序能够相互协调工作，更大的提高工作效率。然而事与愿违，只有很少的软件开发商支持它。为此，微软于1993 年发布了新的规范 OLE2.0，它在原有的基础上完善并增强了以下各方面的性能：</p> <ol><li>OLE自动化：一个程序有计划地控制另一个程序的能力。</li> <li>OLE控件：小型的组件程序，可嵌入到另外的程序，提供自己的专有功能。</li> <li>OLE文档：完善了早期的混合文档功能，不仅支持简单链接和嵌入，还支持在位激活、拖放等功能。</li></ol> <p>强大的功能使得很多的开发商开始支持新的 OLE 技术，因为微软在 OLE2.0 中建立了 COM（Component Object Model即组件对象模式）规范。</p> <p>OLE 相关的基础概念有：</p> <ul><li>容器：
<ul><li>容器是一个客户程序，它具有申请并使用其它COM组件通过接口为其它程序实现的功能；</li></ul></li> <li>服务器：
<ul><li>服务器通过特定的接口将自己完成的一些功能，提供给使用自己的应用程序（例如画笔程序是一个文档服务器，它提供创建并编辑BMP 图像的功能）。当打开Word，选择【插入】菜单下的【对象...】项，您可以看到在您的系统中存在哪些文档服务器，此时的Word以文档容器的身份出现。</li></ul></li> <li>在位激活：
<ul><li>当您双击插入的对象后发现Word的菜单有些改变成文档服务器程序的菜单，可以在当前的环境下编辑对象，这称为在位激活。</li></ul></li></ul> <p>简单的说，OLE 是一种可以用来创建复杂文档的技术，这些复杂文档可以包含来自不同渠道（数据源）的信息，并保留其原始属性。例如，一个支持 OLE 的文档（例如word）能够支持嵌入的表格对象，并且嵌入的文档会保留所有原来的属性。如果用户打算编辑嵌入的数据，windows 操作系统会激活原来的应用程序（如excel）并载入这个嵌入的文档。</p> <h3 id="ole-格式"><a href="#ole-格式" class="header-anchor">#</a> OLE 格式</h3> <p>OLE 文件的 Property Sets 通过以下两个 stream 存储:</p> <ul><li><code>&quot;\005SummaryInformation&quot;</code></li> <li><code>&quot;\005DocumentSummaryInformation&quot;</code></li></ul> <p>这两个 stream 都以 PropertySetStream 结构(见 <a href="">MS-OSHARED</a> 的 section3.2.1 )开头。</p> <p>OLE文件中包含的常见内容主要有：</p> <h4 id="_1-linked-or-embedded-object"><a href="#_1-linked-or-embedded-object" class="header-anchor">#</a> 1. linked or embedded object</h4> <p>包含嵌入、链接对象的容器文档的逻辑布局如下图：
<center class="half"><img src="/blog/assets/img/ole_embedded_object.5730fecc.jpg" width="460"> <img src="/blog/assets/img/ole_linked_object.8828ce15.jpg" width="300"></center></p> <ul><li>OLEStream
<ul><li>OLE2.0 中，由复合文档的以 &quot;\1Ole&quot; 为名的 stream object 包含。OLEStream structure 表述了存储对象是用于 linked object 还是 embedded object。当此结构是为 linked object 指定 storage object 时，它还指定了对此链接对象的引用。</li></ul></li> <li>CompObjStream
<ul><li>OLE2.0 中，名为 &quot;\1CompObj&quot; 的流，主要用于描述 Clipboard Format、用于显示的linked object 或 embedded object 的名字。</li></ul></li> <li>Embedded Object Native Data
<ul><li>OLE1.0 中，其由 EmbeddedObject structure 的 NativeData field 指定。</li> <li>OLE2.0 中，Native Data 的指定方式有以下两种，可以互换使用：
<ul><li>由复合文档的以 &quot;\1Ole10Native&quot; 为名的 stream object 包含。如 OLENativeStream structure 的 NativeData field 所指定。</li> <li>由 creating application 创建的 stream objects 可以包含 native data。此类流对象是 creating application 的私有对象，未在文档中说明。
<ul><li>creating application: An application whose data is stored in or referenced by documents from other applications.</li></ul></li></ul></li></ul></li> <li>Embedded Object Presentation Data
<ul><li>用于指定如何在 container application 中显示 linked or embedded object 对象</li> <li>OLE1.0 中，其由 EmbeddedObject structure 的 Presentation field 指定</li> <li>OLE2.0 中，由复合文档的以 &quot;\2OlePres&quot; 为前缀(后跟着3个十进制数字，并且最多只能有999个Presentations)的 stream objects 指定。每一个 stream 都包含一个 OLEPresentationStream structure。</li></ul></li></ul> <h4 id="_2-宏"><a href="#_2-宏" class="header-anchor">#</a> 2. 宏</h4> <p>常见的 宏 有两种：vba 和 ms-excel4.0, 它们出现的主要位置有：</p> <ul><li>vba project
<ul><li>office97 ~ 2003: vba project storage</li> <li>office2007 ~ : vbaProject.bin</li></ul></li> <li>microsoft office excel 4.0
<ul><li>office97 ~ 2003: book\workbook stream
<ul><li>注：主要通过 BIFF 格式保存了 formula、drawing group 等内容</li></ul></li> <li>office2007 ~ : macrosheets
<ul><li>Microsoft 365 新增 <a href="https://support.microsoft.com/en-us/office/lambda-function-bd212d27-1cd1-4321-a34a-ccbf254b8b67" target="_blank" rel="noopener noreferrer">LAMBDA function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></li> <li>macro template
<ul><li>office2007 ~ : /[xx]/_rels/settings.xml.rels 中引用外部(远程)模板文件</li></ul></li> <li>VbaProjectStg
<ul><li>binary powerpoint document 中用于指定一个用于 VBA project 的结构化存储</li></ul></li></ul> <h4 id="_3-officeart"><a href="#_3-officeart" class="header-anchor">#</a> 3. officeart</h4> <ul><li>office97 ~ 2003:
<ul><li>worddocument、book\workbook、'powerpoint document' stream
<ul><li>Office Drawing Binary File Format (MS-ODRAW)，This file format is also known as OfficeArt.</li></ul></li></ul></li> <li>office2007 ~ :
<ul><li><em>TODO</em></li></ul></li></ul> <h4 id="_4-encryption-and-obfuscation"><a href="#_4-encryption-and-obfuscation" class="header-anchor">#</a> 4. encryption and obfuscation</h4> <p>详见 <a href="/blog/blog/skills/office/ole_office_msoffcrypto.html">Office 格式简析 - Crypto</a></p> <p>这里需要注意的是 vba project 的保护(待确认)：</p> <ul><li>vba project
<ul><li>可以对其中的 stream 设置独立的密码 (未确认)
<ul><li>VBA uses a reversible encryption algorithm for selected data.</li></ul></li> <li>PROJECT Stream: ProjectProtectionState
<ul><li>ProjectProtectionState: &quot;CMG=&quot;0705D8E3D8EDDBF1DBF1DBF1DBF1&quot;&quot; specifies no sources are restricted access to the VBA project. The value is obfuscated by Data Encryption (section 2.4.3).</li> <li>ProjectPassword (section 2.3.1.16): &quot;DPB=&quot;0E0CD1ECDFF4E7F5E7F5E7&quot;&quot; specifies the VBA project has no password. The value is obfuscated by Data Encryption (section 2.4.3).</li> <li>ProjectVisibilityState (section 2.3.1.17): &quot;GC=&quot;1517CAF1D6F9D7F9D706&quot;&quot; specifies the VBA project is visible. The value is obfuscated by Data Encryption (section 2.4.3).</li> <li>LibName: &quot;VBE&quot; specifies a built in name for the VBA Automation type library.</li></ul></li></ul></li></ul> <h3 id="vba-project-格式"><a href="#vba-project-格式" class="header-anchor">#</a> VBA Project 格式</h3> <p>VBA project 是由一系列 records 组成的结构。其中每个 record 都定义了 project 的三要素之一的部分内容。每个 record 都是以结构开头：<code>ID(2 bytes) + Size(4 bytes) + ...</code></p> <p>project 的三要素有：project information, project references, and project items.</p> <h4 id="_1-project-information"><a href="#_1-project-information" class="header-anchor">#</a> 1. project information</h4> <p>ole 中 VBA 存储(storage)结构如下：</p> <p><img src="/blog/assets/img/vba_storage_hierarchy.901caaf9.png" alt="VBA"></p> <p>其中 Project Root Storage 是一个独立的 storage。例如，OLE 文件中的 Macros storage。</p> <ul><li>VBA Storage
<ul><li>sub-structure
<ul><li>_VBA_PROJECT Stream
<ul><li>MUST</li> <li>包含了 VBA project 的基础信息，如，版本号(用于加载此结构的剩余内容) 等</li></ul></li> <li>dir Stream
<ul><li>MUST</li> <li>指明 VBA project properties, project references, 和 module properties</li> <li>The entire stream MUST be compressed as specified in Compression</li></ul></li> <li>&quot;Module Stream&quot;
<ul><li>VBA project 中的每个 module 必须拥有一个 Module Stream</li> <li>VBA project 中 modules 的源码。此 stream 的名字由 MODULESTREAMNAME 指定。</li></ul></li> <li>SRP Streams
<ul><li>Optional</li> <li>指定 特定实现和版本相关 的性能缓存的流。必须是读取时忽略。写入时不得出现。</li></ul></li></ul></li></ul></li> <li>PROJECT Stream
<ul><li>MUST</li> <li>VBA Project Properties, 如 工程的目录结构、脚本类型、module的可编辑窗口的信息等等, 以及一些 VBA project 的附加信息，如：ProjectPassword、ProjectVisibilityState 等 <img src="/blog/assets/img/sample_vba_project.c635a9d2.png" alt="sample_vba_project"> 注：<a href="">[MS-OVBA] - v20200219 的 2.3.1.3 ProjectModule</a> 有脚本类型的相关说明</li></ul></li> <li>PROJECTwm Stream
<ul><li>Optional</li> <li>包含了用于 module name 在 multibyte character set (MBCS) 和 UTF-16 之间互相映射的信息</li></ul></li> <li>PROJECTlk Stream
<ul><li>Optional</li> <li>包含了 VBA project 中的 ActiveX controls 的 license 信息</li></ul></li> <li>Designer Storages
<ul><li>Optional</li> <li>每个 vba project 中的 designer module 都必定有一个与之对应的 designer storage ，此 storage 的名字由 dir stream 中相关 module 中的 MODULESTREAMNAME record 指定。</li> <li>每个 designer storage 必定有一个 VBFrame Stream
<ul><li>VBFrame Stream，用于描述 designer module 的属性信息，此 stream 的名字必须是以 UTF-16 character 0x0003 开头紧接着是  UTF-16 的 &quot;VBFrame&quot;。</li></ul></li> <li>如果此 designer 是一个 Office Form ActiveX control, 那么此 storage 必定包含 <code>[MS-OFORMS] section 2</code>中描述的必须 storages 和 streams。</li></ul></li></ul> <h4 id="_2-project-references"><a href="#_2-project-references" class="header-anchor">#</a> 2. project references</h4> <p>dir Stream 中的 records 包含了 VBA project 对外部资源引用的信息。主要有三类：REFERENCECONTROL、REFERENCEREGISTERED、REFERENCEPROJECT。</p> <h4 id="_3-project-items"><a href="#_3-project-items" class="header-anchor">#</a> 3. project items</h4> <p>VBA project 包含一系列用于嵌入 macros 的 project items。而 project item 是由多个 records 组合定义。主要有以下 5 种 project item(详见 MS-OVBA 文档): <code>project package, document modules, procedural modules, class modules</code> 和 <code>designer modules</code>。</p> <h4 id="_4-pcode"><a href="#_4-pcode" class="header-anchor">#</a> 4. pcode</h4> <p>它并不广为人知，一般来说 VBA 编写的宏以三种不同的可执行形式存在，每种形式都可以是在运行时实际执行的内容，具体取决于具体情况. 它们是：</p> <ul><li>source code
<ul><li>这是最为我们熟知的形式。但大多数情况下，office 会完全忽略源代码。</li> <li>事实上，删除源代码是可能的，但宏仍然可以毫无问题地执行(从 pcode)
<ul><li>这种威胁利用技术被称为 VBA Stomping</li></ul></li></ul></li> <li>p-code
<ul><li>当每行 vba 脚本被输入到 vba 编辑器中时，它会立即被编译成 pcode 并存储到模块流中。 pcode 正是大部分时间被执行的代码。</li> <li>事实上，即使在 vba 编辑器中打开宏模块的源码，显示的也不是解压后的源码，而是反编译成源码的 pcode。</li> <li>只有在使用与创建文档时使用的 vba 版本不同的 office 版本下打开文档时，才会将存储的压缩源代码重新编译为 pcode，然后执行该 pcode</li> <li>这使得可以在支持 vba 的任何版本的 office 上打开包含 vba 的文档，并使内部的宏保持可执行，尽管不同版本的 vba 使用不同(不兼容)的 pcode 指令。</li></ul></li> <li>dxecodes
<ul><li>当 pcode 至少被执行过一次后，它会以进一步标记化形式存储在文档的其他地方(在流中，其名称以 _<em>SRP</em> 开头，后跟一个数字)。从那里它可以执行得更快。</li> <li>但是 execode 的格式极其复杂，并且特定于创建它们的特定 Office 版本(不是 VBA 版本)。这使得它们的通用性很差。</li> <li>此外，它们的存在不是必需的 --- 它们可以被删除并且宏将运行得很好(从 pcode)</li></ul></li></ul> <p>综上，我们可以知道：</p> <ul><li>source 的通用性最好，但只有在 pcode 不能使用时，才会被使用</li> <li>execodes 的通用性最差，但执行得最快</li> <li>p-code 则是执行速度和通用性的折中，也是用的比较广泛的形式</li></ul> <p>因此，我们有必要解析 pcode，具体可以参考：<a href="https://github.com/bontchev/pcodedmp" target="_blank" rel="noopener noreferrer">github.com/bontchev/pcodedmp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="microsoft-office-excel-4-0"><a href="#microsoft-office-excel-4-0" class="header-anchor">#</a> Microsoft Office Excel 4.0</h3> <p>Microsoft Office Excel 4.0, 主要存在于 MS-XLS 的 book\workbook stream 中。此 stream 以 BIFF8(Binary Interchange File Format) 格式组织各个细节。</p> <p>Stream 由以下几部分组成：</p> <ul><li>Globals Substream
<ul><li>描述 workbook 中的全局属性和数据
<ul><li>注意 Lbl、ShrFmla 数据</li></ul></li></ul></li> <li>Chart Sheet Substream</li> <li>Dialog Sheet Substream</li> <li>Macro Sheet Substream</li> <li>Worksheet Substream</li></ul> <p>使用 Excel 4 Macros 的一些细节：</p> <ul><li>使用 relative named range 时，函数主体和结果之间的单元格距离必须都相同，否则可能会计算出错误的结果。</li> <li>Office 2007 ~ 中，任何带有 Excel 4 Macro 的文件都必须另存为启用宏的工作簿 (.xlsm)，尝试另存为标准 Excel 文件将触发以下错误消息:
<img src="data:image/png;base64,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" alt="must_save_excel4_as_xlsm"></li> <li>任何包含数组的函数，例如 GET.WORKSPACE(37) 或 NAMES() 都应该包含在 INDEX 函数中: 如，=INDEX(GET.WORKSPACE(37),!A1)，在这个例子中，A1 包含应该检索的数组中的数字，例如如果 A1 包含值 2，它将返回 GET.WORKSPACE(37) 数组中的第二项。</li> <li>使用 Macro Worksheet 时，工作表设置为显示公式，而不是公式的结果。可以使用 <code>Ctrl + |</code> 在公式视图和结果视图之间切换。</li></ul> <h4 id="ptgexp、shrfmla、array"><a href="#ptgexp、shrfmla、array" class="header-anchor">#</a> PtgExp、ShrFmla、Array</h4> <p>PtgExp 一般会出现在 formula 的第一个 rgce 元素。此时，它表示当前单元格是 array formula 或 shared formula 的一部分。</p> <p>PtgExp.row 和 PtgExp.col 指定了一个在当前 sheet 中的 cell</p> <ul><li>这个 cell 也是 array formula 或 shared formula 的一部分
<ul><li>也就是说必定有一个 formula record 的 row == PtgExp.row &amp;&amp; col == PtgExp.col
<ul><li>紧跟着这个 formula record 的必定是一个 ShrFmla record 或者 Array record</li> <li>也就是说这个 PtgExp 指向了使用此 array formula 或 shared formula 的区域中的 the first cell
<ul><li>隐含：拥有 PtgExp 的 formula record 满足：record.row == PtgExp.row &amp;&amp; record.col == PtgExp.col 时，它后边一定跟着 ShrFmla record 或 Array record</li></ul></li></ul></li> <li>这个 formula record 定义了区域中使用 array formula 或 shared formula 的 the first cell</li></ul></li></ul> <p>ShrFmla(shared formula record)</p> <ul><li>此 record 前必定有一个 formula record，这个 formula record 指定了使用此 shared formula 的区域中的 the first cell</li> <li>其它使用了此 shared formula 的 formula records 后续会出现，但不一定是连续的</li> <li>使用了此 shared formula 的 formula records 会有 Formula.fShrFmla bit 被置位，同时 Formula.cell 必定位于 ShrFmla.ref 指定的区域内</li></ul> <p>Array(array formula record)</p> <ul><li>此 record 前必定有一个 Formula record，这个 formula record 指定了使用此 array formula 的区域中的 the first cell</li> <li>其它使用了此 array formula 的 formula records 后续会出现，但不一定是连续的</li> <li>使用了此 array formula 的 formula records 必定有 Formula.cell 位于 Array.ref 指定的区域内，同时这些使用 array formula 的 formula 的 rgce 必定以 PtgExp 开头。</li></ul> <h4 id="解析过程中遇到的问题"><a href="#解析过程中遇到的问题" class="header-anchor">#</a> 解析过程中遇到的问题</h4> <ul><li>RgceLoc 可以按照 RgceLocRel 来解析，以简化解析流程。</li> <li>解析 formula 的过程中，会遇到 &quot;is part of a revision or not&quot; 的分支流程，这里涉及以下三个概念：
<ul><li>UserBView Record:
<ul><li>fPersonalView : MUST be 0 if this is not a shared workbook.</li></ul></li> <li>Revision Stream
<ul><li>An instance of the Revision Stream specifies the revision logs (section 2.2.11.2) and revision records (section 2.2.11.3) for a shared workbook (section 2.2.11).</li> <li>The name of this stream MUST be &quot;Revision Log&quot;. A file MUST contain at most one Revision Stream. The Revision Stream MUST exist if the workbook is a shared workbook.</li></ul></li> <li>Revision Records
<ul><li>a series of records. 详情可以参考 [MS-XLS] 文档。</li></ul></li></ul></li> <li>external references：
<ul><li>Supporting Link 包含了 Self-Referencing、Same-Sheet Referencing、External Workbook Referencing 等等类型。</li></ul></li> <li>name manager:
<ul><li>LblRecord : (关联 name 和 sheet)
<ul><li>内置名字的索引，可能由 1 或 2 字节表示</li> <li>NameParsedFormula 可能出现 ptgRef3d 的 ixti == 0xFFFF，此时，此时的结构未被文档记录：
<ul><li>we can reproduce it: make a macro sheet in ooxml and export it to xls.</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>  		uint8_t ptg = uint8_t(data[cce_offset] &amp; 0x7f);
  		if (ptg == ptgRef3d || ptg == ptgRef3dA || ptg == ptgRef3dV) {
  			uint16_t ixti = *(uint16_t*)(data + cce_offset + 1);
  			if (ixti &gt; 0xFF00 &amp;&amp; record-&gt;cce &gt;= 15 + 3) {
  				assert(record-&gt;itab == 0 || record-&gt;itab == 1);
      uint16_t iscope_1base = (record-&gt;itab == 1) ? record-&gt;reserved1 : record-&gt;itab;
  				uint16_t isheet_0base_a = *(uint16_t*)(data + cce_offset + 11);
  				uint16_t isheet_0base_b = *(uint16_t*)(data + cce_offset + 13);
  				assert(isheet_0base_a == isheet_0base_b);
  				auto row = *(uint16_t*)(data + cce_offset + 15);
  				auto col = (uint16_t)*(uint8_t*)(data + cce_offset + 17);
  			}
  		}
  	}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul></li></ul></li> <li>Rgce 的 ACTUAL_PTG_SIZE 跟实际情况不符合</li></ul> <h3 id="doc"><a href="#doc" class="header-anchor">#</a> DOC</h3> <p>一个 doc 文档应当由以下几个部分组成：</p> <ol><li>WordDocument stream
<ul><li>有一个 FIB structure 在流的起始位置</li></ul></li> <li>Table stream
<ul><li>1Table 或者 0Table 流必定存在。当二者同时存在时，base.fWhichTblStm 指定的为有效流，忽略其他即可。</li> <li>如果文档被加密的话，会有一个 EncryptionHeader 结构在流的起始位置。反之，如果文档没有加密，则此流没有预定义的结构。</li> <li>存储了文档的文本信息</li></ul></li> <li>Data stream
<ul><li>没有预定义的结构，也不是必定存在。它包含的是 FIB 或 文件的其它部分的引用数据，也就是说如果没有引用数据的话，这个流没有存在的必要</li></ul></li> <li>ObjectPool storage
<ul><li>Object Pool storage 包含一些用于持久化 embedded OLE objects 的 storages。如果文档没有 embedded OLE objects 时，是不会出现此 storage 的。</li> <li>每一个位于 ObjectPool storage 中的 storage 都有一个 ObjInfo Stream (名为 &quot;\003ObjInfo&quot;)，这个流里存放着用于描述 embedded OLE object 信息的 ODT structure。
<ul><li>embedded OLE object 相关的其他流的描述可以参考 <a href="">Embedded Object Native Data</a> 相关内容</li></ul></li> <li>每个 sub-storage 都存储了一个用户嵌入(embedded)的文件。并且，每个 sub-storage 都是以: 下划线&quot;_&quot; + 10个digits 组成，如 _1557814583
<ul><li>关联引用的关键词：sprmCFOle2、sprmCPicLocation</li></ul></li></ul></li> <li>Summary Information
<ul><li>Summary Information stream</li> <li>Document Summary Information stream</li> <li>Encrypt stream
<ul><li>名为 encryption 的流，只有当以下两个条件同时满足才会出现：文档被 RC4 CryptoAPI 加密， 并且，EncryptionHeader.Flags 的 fDocProps 标记被置位</li></ul></li></ul></li> <li>Macros stream
<ul><li>vba project</li></ul></li> <li>Signature
<ul><li>参考 <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/2770c801-5f0f-4326-89e8-d6ef15b68ef1" target="_blank" rel="noopener noreferrer">MS-OFFCRYPTO<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中的说明。</li></ul></li> <li>Protected Content</li></ol> <ul><li>由 IRMDS 描述的方式进行保护的内容, 在 <a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/278b0e42-9080-48fc-806f-7d4f6b264fb0" target="_blank" rel="noopener noreferrer">MS-OFFCRYPTO<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 有描述。</li></ul> <h3 id="ppt"><a href="#ppt" class="header-anchor">#</a> PPT</h3> <p>按照 [MS-PPT] - v20210817 ：pageno 28 中 Part 1 ~ 11 的描述，即可解出完整的 ppt 文档内容。</p> <p>注意：the UserEditAtom record closest to the end of the PointPower Document stream</p> <p>其中，所有用于 presentation 的文本都存储在 &quot;PowerPoint Document&quot; stream 中；所有用于 presentation 的 images 都存储在Pictures stream 中；不过，Embedded files 没有存储在独立的 storages，而是被融合到 &quot;PowerPoint Document&quot; stream 中，此外，这些 embedded files 在存储时，有些会被压缩有些却不会。</p> <h4 id="external-objects"><a href="#external-objects" class="header-anchor">#</a> External Objects</h4> <p>Slides 可以包含连接到外部的 objects。播放 ppt 的人可以在幻灯片放映期间激活链接对象以访问外部资源。External Objects 的例子有 embedded and linked audio, linked video, embedded and linked OLE objects, 以及 hyperlinks。</p> <p>也就是说 Embedded or Linked Object 在 ppt 中的存在形式就是 External Objects。</p> <p>有关有 External Objects 的记录，请参阅 <a href="">[MS-PPT] External Object Types (section 2.10)</a> 相关内容。简单的说，为了解析出 External Objects，我们需要关注：</p> <ul><li>ExternalOleObjectStg 0x1011 , 用于对象存储(如果有n个则会有n个此类型的 record)</li> <li>DocumentContainer 0x03E8 , 用于描述文档对象
<ul><li>DocInfoListContainer 0x07D0
<ul><li>VBAInfoContainer 0x03FF
<ul><li>VBAInfoAtom  0x0400</li></ul></li></ul></li> <li>ExObjListContainer 0x0409
<ul><li>storage for compressed/uncompressed OLE/VBA/ActiveX control data, 如 VbaProjectStg</li></ul></li> <li>SoundCollectionContainer</li> <li>DrawingGroupContainer</li></ul></li></ul> <p>也就是说要首先找到 DocumentContainer：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1. 构造 PersistDirectory
  Current User Stream
    CurrentUserAtom Record
      offsetToCurrentEdit field
  |--&gt;PowerPoint Document Stream
  |		UserEditAtom
  |			offsetPersistDirectory field
  |		PersistDirectoryAtom
  UserEditAtom.offsetLastEdit (Repeat until offsetLastEdit is 0x000000)

2. 定位 DocumentContainer
  UserEditAtom.docPersistIdRef
    DocumentContainer Record
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>关于鉴别 embedded OLE object 对象的具体步骤可以参考 <a href="">[MS-PPT] 2.1.2 PowerPoint Document Stream  part 9</a> 相关内容</p> <p>关于鉴别 linked OLE object 对象的具体步骤可以参考 <a href="">[MS-PPT] 2.1.2 PowerPoint Document Stream  part 10</a> 相关内容</p> <h3 id="xls"><a href="#xls" class="header-anchor">#</a> XLS</h3> <p>一个 xls 文件最多只能一个 Component Object Stream。
一个 xls 文件最多只能一个 OLE Stream。
一个 xls 文件最多只能一个 Control Stream。</p> <p>WorkBook stream 中存储了 excel 中所有的 text 和 formulas。</p> <h4 id="embedded-or-linked-object"><a href="#embedded-or-linked-object" class="header-anchor">#</a> Embedded or Linked Object</h4> <p>在 Excel 的 workbook 中嵌入一个文件的话，这些文件会被存储在名为 &quot;MBD + 随机的8个十六进制数字&quot; 的 Embedding Storages 中。</p> <p>每个 Embedding Storage 都表示了一个基于 storage-based 持久化的 embedded OLE object 或 ActiveX control 对象。同时，持久化在 Embedding Storage 的对象必定有一个相关联的 Obj record 在 worksheet substream、macro sheet substream 或 dialog sheet substream 中，并且 cmo.ot == 8，pictFlags.fPrstm == pictFlags.fDde == 0。</p> <p>不过不同类型的文件在 Embedding Storage 中的形式有些不一样，如：</p> <ol><li>如果 embedded file 是另外一个 binary Office document, 那么这个 embedded file 中的 storages 和 streams 会被当成对应的节点原样存储在 MDB storage 中</li> <li>如果 embedded file 是一个 Open XML document, 那么这个 embedded file 会被完整存储在名为 &quot;Package&quot; 的 stream 中</li></ol> <p>一个 Link Storage 指定一个 linked OLE object 和任意其他的默认数据或表示为其建立的缓存。它的名字必定是由：&quot;LNK&quot; + 8个十六进制数字 标识。持久化在 Link Storage 的对象必定有一个相关联的 Obj record (Obj.pictFmla.lPosInCtlStm)在 worksheet substream、macro sheet substream 或 dialog sheet substream 中，并且 cmo.ot == 8，pictFlags.fPrstm == pictFlags.fDde == 0。</p> <h2 id="ooxml"><a href="#ooxml" class="header-anchor">#</a> OOXML</h2> <p>OOXML(Office Open XML File Formats), 简单来说，OOXML 是一个基于 XML 的文档格式标准，最早是微软 Office2007 的产品开发技术规范，先是成为 Ecma(ECMA-376) 的标准，最后改进推广成为了 ISO 和 IEC (as ISO/IEC 29500) 的国际文档格式标准。也就是说，通过 OOXML 标准，我们能够在不依赖 Office 产品的情况下，在任何平台读写Office Word，PPT 和 Excel 文件。</p> <p>OOXML 的主要目录结构如下所示：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>OOXML
├── [Content_Types].xml // 描述文档各个部分的ContentType，协助解析文档
│           
├─ docProps        // ms-office 需要此内容以打开文件，而 wps 不需要
│   ├── app.xml    //程序级别的文档属性，如：页数、文本行数、程序版本等
│   └── core.xml   //用户填写的文档属性，如：标题、主题、作者等
│
├─ _rels
│   └── .rels      //描述各个部分之间的关系
│
└─ word / xl / ppt
    ├── document.xml     //word
    ├── fontTable.xml    //word，页脚
    │
    ├── workbook.xml     // xl
    ├── worksheets       // xl
    │    └── sheet1.xml
    ├── macrosheets      // xl, microsoft excel 4.0 macros
    │      ├── _rels
    │      │   └── sheet1.xml.rels
    │      └── sheet1.xml
    |
    |── presentation.xml // ppt
    |
    |── embeddings       //all, optional, 存放 embedded files
    |     ├── a
    |     └── b
    │
    |── vbaData.xml      //all, vba属性，是否auoopen，是否加密
    |── vbaProject.bin   //all, 记录 vba project 信息, ole 格式
    |
    ├─ theme             //all, 记录样式，颜色编号，字体大小等等
    │    └── theme1.xml
    │
    ├─ _rels             //all, relationships
    |    ├── settings.xml.rels   // 指定 模板 引用
    │    ├── document.xml.rels   // 使用 ID 和 URL 来定义文档各零件
    |    ├── workbook.xml.rels   // 使用 ID 和 URL 来定义文档各零件
    │    └── vbaProject.bin.rels // vba
    │ 
    ├── printerSettings //all, Reference to Printer Settings Data
    │....└── printerSettings1.bin
    │
    └─ styles.xml       //all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="_1-name-representation"><a href="#_1-name-representation" class="header-anchor">#</a> 1. Name Representation</h3> <p>无论是 definedNames 中定义的，还是表格显示的名字，这些需要展示的名字都应当在 <code>docProps\app.xml</code> 中作为 Application-Defined File Properties 部分被定义，如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;TitlesOfParts&gt;
 &lt;vt:vector size=&quot;[0-9]+&quot; baseType=&quot;lpstr&quot;&gt;
  &lt;vt:lpstr&gt;Sheet1&lt;/vt:lpstr&gt;
  &lt;vt:lpstr&gt;Sheet2&lt;/vt:lpstr&gt;
  &lt;vt:lpstr&gt;Sheet3&lt;/vt:lpstr&gt;
  &lt;vt:lpstr&gt;value1&lt;/vt:lpstr&gt;
  &lt;vt:lpstr&gt;value2&lt;/vt:lpstr&gt;
 &lt;/vt:vector&gt;
&lt;/TitlesOfParts&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_2-cell-references-name"><a href="#_2-cell-references-name" class="header-anchor">#</a> 2. Cell References &amp; Name</h3> <p>excel中可以给 函数、cell、sheet、甚至任意一段文本或图形等定义名字(也被称为 bookmark)，并通过名字来引用对应的内容，引用方式参考</p> <ul><li><a href="">ECMA-376-Fifth-Edition-Part-1 --- 18.17.2.3 Cell References</a></li> <li><a href="">ECMA-376-Fifth-Edition-Part-1 --- 18.17.2.5 Names </a></li></ul> <p>name 的组成形式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>name = [ workbook-name, &quot;!&quot; ], [letter | &quot;_&quot; | &quot;\&quot;], [ letter | decimal-digit | &quot;_&quot; | &quot;.&quot; ] ;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中 name 不能包含以下几种格形式：</p> <ul><li>TRUE or FALSE</li> <li>user-defined-function-name</li> <li>cell-reference</li></ul> <p>function-name 的组成形式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>function-name= prefixed-function-name | predefined-function-name | user-defined-function-name ;

predefined-function-name= &quot;ABS&quot; | &quot;ACOS&quot; | &quot;ACOSH&quot; | ( any of the other functions defined in §18.17.7) ;
prefixed-function-name= &quot;ISO.&quot;, predefined-function-name | &quot;ECMA.&quot;, predefined-function-name ; 
user-defined-function-name= letter, [ letter | decimal-digit | &quot;.&quot; ] ;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其中 function-name 不能包含以下几种格形式：</p> <ul><li>TRUE or FALSE</li> <li>name</li> <li>cell-reference</li></ul> <p>Cell Reference 的形式有两种：R1C1-Style 和 A1-Style</p> <p>operator 有以下几种格式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;:&quot; | comma | space | &quot;^&quot; | &quot;*&quot; | &quot;/&quot; | &quot;+&quot; | &quot;-&quot; | &quot;&amp;&quot; | &quot;=&quot; | &quot;&lt;&gt;&quot; | &quot;&lt;&quot; | &quot;&lt;=&quot; | &quot;&gt;&quot; | &quot;&gt;=&quot; | &quot;%&quot; ;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-formulas-and-expressions"><a href="#_3-formulas-and-expressions" class="header-anchor">#</a> 3. Formulas and expressions</h3> <ul><li><a href="">ECMA-376-Fifth-Edition-Part-1 --- 17.16.3 Formulas and expressions</a></li></ul> <p>A field instruction can involve a calculation via a formula, which is simply an expression that is an arbitrary complex arithmetic expression，如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;sheetData&gt;
		&lt;row r=&quot;2&quot; spans=&quot;4:4&quot; x14ac:dyDescent=&quot;0.25&quot;&gt;
			&lt;c r=&quot;D2&quot; s=&quot;1&quot; t=&quot;b&quot;&gt;
				&lt;f&gt;FORMULA()=FORMULA()=FORMULA('Buk1'!E11,'Buk2'!B12)=FORMULA('Buk2'!H5,'Buk3'!H3)=FORMULA('Buk3'!C9,'Buk4'!C2)=FORMULA('Buk4'!I8,'Buk5'!F2)=FORMULA('Buk5'!B12,'Buk6'!B10)=FORMULA('Buk6'!G3,'Buk7'!I2)=FORMULA('Buk7'!D13,'Buk1'!A3)=FORMULA('Buk3'!H3&amp;amp;'Ss1'!O6&amp;amp;'Ss1'!D16&amp;amp;'Ss1'!K13&amp;amp;'Ss1'!R12&amp;amp;'Ss1'!R14,D3)=FORMULA('Buk3'!H3&amp;amp;'Buk7'!I2&amp;amp;'Buk4'!C2&amp;amp;'Buk5'!F2&amp;amp;'Buk5'!F2&amp;amp;Ss1br2!B3&amp;amp;'Buk1'!A3&amp;amp;Ss1br2!D5&amp;amp;'Buk6'!B10&amp;amp;Ss1br2!G3&amp;amp;'Buk7'!I2&amp;amp;'Buk7'!I2&amp;amp;Ss1br2!B9,D17)&lt;/f&gt;
				&lt;v&gt;1&lt;/v&gt;
			&lt;/c&gt;
		&lt;/row&gt;
	&lt;/sheetData&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="ms-office-的其他形式"><a href="#ms-office-的其他形式" class="header-anchor">#</a> MS-Office 的其他形式</h2> <p>使用 MS-Office 软件可以将 office 文件通过&quot;另存为&quot;保存为 xml、mhtml、html 等格式的文本文件，并且，可以再次通过 MS-Office 软件打开、编辑。</p> <p>另外，这些转换而成的文本类型的文档，被加密后，是一个 ole 文件。</p> <p>被转换而成的 xml 文件，在结构上保持了跟 binary 形式的 office 文件一致，并且一一对应。如，contentType 为 &quot;application/vnd.ms-office.vbaProject&quot; 的 binaryData 数据, 就是二进制形式的 vbaProject 内容 base64 后的结果。</p> <p>这里要注意的是，在解析 binData 类型的数据时，可能会遇到 mso(ActiveMine) 文件。这是一种文件名为 *.mso 同时 MIME Types 为 application/x-mso 的结构未公开的文件格式(参考
<a href="https://github.com/idiom/activemime-format" target="_blank" rel="noopener noreferrer">activemime-format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> )。</p> <p>MSO文件是将Microsoft Office文档保存为网页时创建的宏引用文件。它包含有关原始文件中包含的宏和OLE（对象链接和嵌入）对象的信息，并且可以被创建的网页作为样式表引用。MSO文件可以用文本编辑器查看，但由于内容是编码的，因此无法读取。大多数用户只会将MSO文件作为电子邮件的附件。</p> <h2 id="rtf"><a href="#rtf" class="header-anchor">#</a> RTF</h2> <p>富文本格式（Rtf，rich text tormat）是微软的文本和图像信息交换指定的格式。Rtf文件可以划分为文件头和文档区两个部分组成。文件头和文档区由文本、控制字和控制符组成，同时利用{…}来表明层级关系。</p> <h3 id="检出"><a href="#检出" class="header-anchor">#</a> 检出</h3> <ul><li>hash (忽略大小写、空字符)
<ul><li>function</li> <li>stream</li></ul></li> <li>模糊匹配
<ul><li>简单的模式匹配</li> <li>eg.
<ul><li>搜索到 ：VirtualProtectEx、WriteProcessMemory、CreateRemoteThread、VirtualAllocEx</li> <li>Shell Environ$(&quot;comspec&quot;) &amp; &quot; /c attrib -S -h &quot;&quot;&quot; &amp; Application.StartupPath &amp; &quot;\K4.XLS&quot;&quot;&quot;, vbMinimizedFocus</li> <li>Shell (&quot;\jdq\cc$\b.exe&quot;)</li> <li>If .Lines(1, 1) = &quot;APMP&quot; &amp; .Lines(1, 2) &lt;&gt; &quot;KILL&quot; Then ........ End If</li> <li>混淆的文件：熵 ？</li></ul></li></ul></li></ul> <h3 id="清理"><a href="#清理" class="header-anchor">#</a> 清理</h3> <ul><li>抹除
<ul><li>function
<ul><li>替换函数内容为空格</li></ul></li> <li>stream :
<ul><li>将 stream 的 size 置 0，同时抹除第一个扇区内容，断开内容扇区链</li> <li>一般来说，只修改 size 就可以让 office 软件无法读取相关内容。但其他杀软可能会继续报毒，毕竟 stream 的其他信息依然有效，可以在容错情况下还原出来 malicious 内容。</li> <li>注意：其它部分对 macro 的引用，如：
<ul><li>doc 中 fcCmds 会通过 macro names 引用对应的宏，所以
<ol><li>根据需要将 document 流中的 fcCmds 和 lcbCmds 所引用的数据</li> <li>粗暴的将 document 流中的 fcCmds 和 lcbCmds 都置空</li></ol></li></ul></li></ul></li></ul></li> <li>还原
<ul><li>还原被加密破坏的文件内容
<ul><li>病毒感染时是有机会操作原有的正常 vba 脚本的，比如，加密（目前还没见到此类样本）。</li></ul></li></ul></li></ul> <h2 id="reference"><a href="#reference" class="header-anchor">#</a> Reference</h2> <ul><li><p><a href="https://docs.microsoft.com/zh-cn/deployoffice/compat/office-file-format-reference" target="_blank" rel="noopener noreferrer">MS-Office-Extensions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offfflp/8aea05e3-8c1e-4a9a-9614-31f71e679456" target="_blank" rel="noopener noreferrer">MS-Office File Formats<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-ovba/575462ba-bf67-4190-9fac-c275523c75fc" target="_blank" rel="noopener noreferrer">[MS-OVBA] - v20210817<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-offcrypto/3c34d72a-1a61-4b52-a893-196f9157f083" target="_blank" rel="noopener noreferrer">[MS-OFFCRYPTO] - v20210817<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/cd03cb5f-ca02-4934-a391-bb674cb8aa06" target="_blank" rel="noopener noreferrer">[MS-XLS] - v20210817<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-doc/ccd7b486-7881-484c-a137-51170af7cc22" target="_blank" rel="noopener noreferrer">[MS-DOC] - v20210817<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-ppt/6be79dde-33c1-4c1b-8ccc-4b2301c08662" target="_blank" rel="noopener noreferrer">[MS-PPT] - v20210817<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/85583d21-c1cf-4afe-a35f-d6701c5fbb6f" target="_blank" rel="noopener noreferrer">[MS-OLEDS] - v20210625<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/zh-cn/previous-versions/office/developer/office-2007/aa338205(v=office.12)" target="_blank" rel="noopener noreferrer">Introducing the Office (2007) Open XML File Formats<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="http://download.microsoft.com/download/5/0/1/501ED102-E53F-4CE0-AA6B-B0F93629DDC6/Office/Excel97-2007BinaryFileFormat(xls)Specification.pdf" target="_blank" rel="noopener noreferrer">Microsoft Office Excel 97 - 2007 Binary File Format (.xls) Specification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/fdc5e702-d09e-4344-a77f-eb079d41f23f" target="_blank" rel="noopener noreferrer">OLE1.0 and OLE2.0 Formats<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="">Microsoft Office Word 2003</a></p> <ul><li><a href="https://docs.microsoft.com/en-us/previous-versions/office/aa203677(v=office.11)?redirectedfrom=MSDN" target="_blank" rel="noopener noreferrer">Microsoft Office Word 2003 Preview<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.microsoft.com/en-us/archive/msdn-magazine/2003/november/the-xml-files-xml-in-microsoft-office-word-2003" target="_blank" rel="noopener noreferrer">The XML Files: XML in Microsoft Office Word 2003<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p><a href="https://bbs.pediy.com/thread-218941.htm" target="_blank" rel="noopener noreferrer">[翻译]攻击互通性-以OLE为例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><a href="https://www.blackhat.com/docs/us-15/materials/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf" target="_blank" rel="noopener noreferrer">Attacking Interoperability: An OLE Edition<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p><a href="https://bbs.ichunqiu.com/thread-35164-1-1.html" target="_blank" rel="noopener noreferrer">宏病毒常用的一些trick<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://outflank.nl/blog/2018/10/06/old-school-evil-excel-4-0-macros-xlm/" target="_blank" rel="noopener noreferrer">Old school: evil Excel 4.0 macros (XLM)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://github.com/decalage2/oletools/tree/master/oletools" target="_blank" rel="noopener noreferrer">oletools<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>DidierStevens</p> <ul><li><a href="https://blog.didierstevens.com/programs/oledump-py/" target="_blank" rel="noopener noreferrer">oledump-py<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py" target="_blank" rel="noopener noreferrer">oledump.py<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.didierstevens.com/2020/03/31/update-msoffcrypto-crack-py-version-0-0-5/" target="_blank" rel="noopener noreferrer">msoffcrypto-crack.py<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p>0xevilc0de</p> <ul><li><a href="https://0xevilc0de.com/maldoc-uses-template-injection-for-macro-execution/" target="_blank" rel="noopener noreferrer">Maldoc uses template injection for macro execution<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://0xevilc0de.com/excel-4-macros-get-workspace-reference/" target="_blank" rel="noopener noreferrer">Excel 4 Macros – Get.Workspace Reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://0xevilc0de.com/removing-passwords-from-vba-projects/" target="_blank" rel="noopener noreferrer">Removing Passwords from VBA Projects<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://0xevilc0de.com/maldoc-uses-rc4-to-hide-powershell-script-retrieves-payload-from-dns-txt-record/" target="_blank" rel="noopener noreferrer">Maldoc uses RC4 to hide PowerShell script, retrieves payload from DNS TXT record<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://0xevilc0de.com/maldoc-uses-windows-api-to-perform-process-hollowing/" target="_blank" rel="noopener noreferrer">Maldoc uses Windows API to perform process hollowing<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p>jstrosch</p> <ul><li><a href="https://github.com/jstrosch/malware-samples" target="_blank" rel="noopener noreferrer">malware-samples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p>spiderlabs</p> <ul><li><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/" target="_blank" rel="noopener noreferrer">spiderlabs-blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p><a href="https://sevrosecurity.com/2019/09/12/dynamic-office-template-injection-for-sandbox-bypass/" target="_blank" rel="noopener noreferrer">Template Injection<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><a href="https://github.com/jstrosch/malware-samples/tree/master/maldocs/unknown/2020/May" target="_blank" rel="noopener noreferrer">malware-samples: Word Doc uses Template Injection<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p><a href="https://www.cnblogs.com/AspDotNetMVC/p/3810839.html" target="_blank" rel="noopener noreferrer">复合文档文件格式研究<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://blogs.vmware.com/networkvirtualization/2020/11/velvetsweatshop-when-default-passwords-can-still-make-a-difference.html/" target="_blank" rel="noopener noreferrer">VelvetSweatshop: Default Passwords Can Still Make a Difference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://docs.remnux.org/discover-the-tools/analyze+documents" target="_blank" rel="noopener noreferrer">REMnux: Analyze Documents<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <div class="tags"><a href="/blog/tags/?tag=ole" title="标签">#ole</a><a href="/blog/tags/?tag=ms-cfb" title="标签">#ms-cfb</a><a href="/blog/tags/?tag=office" title="标签">#office</a></div> <!----></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/blog/skills/utils/windows_wallpapers.html"><div>
            Windows Wallpapers
            <!----></div></a> <span class="date">03-10</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/blog/xnote/about_acknowledge.html"><div>
            关于总结
            <!----></div></a> <span class="date">01-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/blog/xnote/rnote_deep_mind.html"><div>
            deep mind
            <!----></div></a> <span class="date">01-17</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:929843628@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/joyous-x" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2022
    <span>Jiao | <a href="https://github.com/joyous-x/blog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/blog/assets/js/app.d6ef53bd.js" defer></script><script src="/blog/assets/js/2.105f29df.js" defer></script><script src="/blog/assets/js/3.858ab1d1.js" defer></script>
  </body>
</html>
